---
title: "Defense Services Exercised Options"
author: "Greg Sanders, Justin Graham"
date: "Friday July 13, 2019"
output:
  html_document:
    keep_md: yes
--- 

Modeling Likelihood of Some or All Options being Exercised
============================================================================

#Setup and  Load Data
First we load the data. The dataset used is a U.S. Defense Contracting dataset derived from FPDS.

```{r Libraries, echo = FALSE, results = FALSE, message = FALSE, warning = FALSE}
library(csis360)
library(ggplot2)
library(arm)
library(R2WinBUGS)
library(dplyr)
library(Hmisc)
library(stargazer)
library(optimx)
source("C:/Users/JGraham/Documents/CSIS/Vendor/Scripts/DIIGstat.r")

axis.text.size<-10
strip.text.size<-10
legend.text.size<-8
# table.text.size<-5.75
title.text.size<-12
geom.text.size<-12

main.text.size<-1
note.text.size<-1.40

load(file="..//data//semi_clean//serv_opt.rdata")

```

Two models are employed throughout, one looking at the probability of some options being exercised  and the other looking at all (or at least 95%) options being exercised in dollar terms.  This approach was taken to avoid clustering at zero and one problems. The second model only includes as a sample those contracts with some options exercised, while the first model is calculated on the full dataset.

#Study Variables

##Services Complexity
Expectation: Higher service complexity would make work more demanding and thus raises the risks of negative contracting outcomes, namely the likelihood exercised options decreases.

### 01A NAICS6 Salary
Expectation: Given the fact that one source for higher salaries is the difficulty of the work and the experience and education required, as average NAICS6 salary increases, we expect likelihood of both some options being exercised and all options being exercised to decrease.

```{r Model01A}
summary_continuous_plot(serv_opt,metric="opt","cln_US6sal")


#Model
b_SomeOpt01A <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_US6sal, family=binomial(link="logit"))


b_AllOpt01A <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_US6sal)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt01A,b_AllOpt01A,type="text",
                       digits=2)


```
Expectations are met.


### 01B Invoice Rate
Expectation: The invoice rate approximates how much the government is charged annually for each comparable full-time employee who is supporting the service contracts. A higher invoice rate indicates a more complex service. As invoice rate increases, we expect likelihood of both some options being exercised and all options being exercised to decrease.

```{r Model01B}

summary_continuous_plot(serv_opt,metric="opt","cln_PSCrate")


#Model
b_SomeOpt01B <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_PSCrate, family=binomial(link="logit"))

b_AllOpt01B <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_PSCrate)



#Plot residuals versus fitted
  stargazer::stargazer(b_SomeOpt01A,b_SomeOpt01B,
                       b_AllOpt01A,b_AllOpt01B,
                       type="text",
                       digits=2)


```

Expectations met.

### 01C Service Complexity
Expectation: Collectively, the higher average salary and invoice rate (more complexity is indicated), we expect the likelihood of both some options being exercised and all options being exercised to decrease.

 
```{r Model01C}

#Model
b_SomeOpt01C <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_US6sal + cln_PSCrate, family=binomial(link="logit"))
glmer_examine(b_SomeOpt01C)

b_AllOpt01C <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_US6sal +  cln_PSCrate)

glmer_examine(b_AllOpt01C)
#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt01A,b_SomeOpt01B,b_SomeOpt01C,
                       
                       b_AllOpt01A,b_AllOpt01B,b_AllOpt01C,
                       type="text",
                       digits=2)

undebug(summary_residual_compare)
summary_residual_compare(b_SomeOpt01A,b_SomeOpt01C,b_SomeOpt01B, bins=3)
summary_residual_compare(b_AllOpt01A, b_AllOpt01C, b_AllOpt01B, bins=3)
```

Expectations are met for all variables, except for average salary in the model of some options being exercised, which is no longer statistically significant.

## Office Capacity

### 02A: Performance Based Services
Expectation: Performance-based services contracting ties a portion of a contractor's payment, contract extensions, or contract renewals to the achievement of specific, measurable performance standards and requirements, which encourages better contracting results. As percent PBSC increases, we expect likelihood of both some options being exercised and all options being exercised to increase.

```{r Model02A}
summary_continuous_plot(serv_opt,metric="opt","pPBSC")

#Model
b_SomeOpt02A <- glm (data=serv_opt,
                 b_SomeOpt ~ cp_OffPerf7, family=binomial(link="logit"))

b_AllOpt02A <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cp_OffPerf7)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt01C,b_SomeOpt02A,
                       b_AllOpt01C,b_AllOpt02A,
                       type="text",
                       digits=2)


```

Expectations are not met - percent PBSC has a statistically significant, strongly negative, effect in both models.


### 02B: No.Office PSC History
Expectation: The increasing share of contracting office obligations for a given service indicates high capcaity in that area, so we expect the likelihood of both some options being exercised and all options being exercised to increase.

```{r Model02B}

summary_continuous_plot(serv_opt,metric="opt","cp_OffPSC7")

#Model
b_SomeOpt02B <- glm (data=serv_opt,
                 b_SomeOpt ~ cp_OffPSC7, family=binomial(link="logit"))

b_AllOpt02B <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cp_OffPSC7)

#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt01C,b_SomeOpt02A,b_SomeOpt02B,
                       b_AllOpt01C,b_AllOpt02A,b_AllOpt02B,
                       type="text",
                       digits=2)


```

Expectations are not met.  In the SomeOpt model, cp_OffPSC7 has a non-statistically negative effect, while in the AllOpt model, it has a very strong negative, statistically significant, effect.


### 02C: Office Capacity
Expectation: Collectively, the larger share of PBSC and contracting office obligations for a given service, we expect the likelihood of both some options being exercised and all options being exercised to increase.

```{r Model02C}


#Model
b_SomeOpt02C <- glm (data=serv_opt, family=binomial(link="logit"),
                 b_SomeOpt ~ cp_OffPerf7+cp_OffPSC7)
glmer_examine(b_SomeOpt02C)

b_AllOpt02C <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cp_OffPerf7+cp_OffPSC7)

glmer_examine(b_AllOpt02C)

#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt01C,b_SomeOpt02A,b_SomeOpt02B,b_SomeOpt02C,
                       type="text",
                       digits=2)


stargazer::stargazer(b_AllOpt01C,b_AllOpt02A,b_AllOpt02B,b_AllOpt02C,
                       type="text",
                       digits=2)



summary_residual_compare(b_SomeOpt02A,b_SomeOpt02C,b_SomeOpt02A,b_AllOpt02B)


```
For the SomeOpt model, the residual plot is wonky (smooth downward concave curve), so we may want to show some concern about the validity of the given result.  For the SomeOpt model, some expectations are now met when these variables are specified together - percent PBSC still has a statistically significant negative effect, but cp_OffPSC7 now flips to statistically significant and positive, as initially expected.

For the AllOpt model, expectations are uniformly violated, though percent PBSC is no longer statistically significant (still negative though), and cp_OffPSC7 remains statistically significant and strongly negative.


### 02D: Cumulative  Model
Expectation: When all the four variables are combined into one model, same expectations are applied as individual ones. Per service complexity indicator increase, we expect the likelihood of both some options being exercised and all options being exercised to decrease. Per office capacity indicator increase, we expect the likelihood of both some options being exercised and all options being exercised to increase.

```{r Model02D}


#Model
b_SomeOpt02D <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_US6sal + cln_PSCrate+ cp_OffPerf7+cp_OffPSC7, family=binomial(link="logit"))
glmer_examine(b_SomeOpt02D)

b_AllOpt02D <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_US6sal + cln_PSCrate+ cp_OffPerf7+cp_OffPSC7)

glmer_examine(b_AllOpt02D)
#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt01C,b_SomeOpt02C,b_SomeOpt02D,
                       
                       b_AllOpt01C,b_AllOpt02C,b_AllOpt02D,
                       type="text",
                       digits=2)



summary_residual_compare(b_SomeOpt02C,b_SomeOpt02D,
                         b_AllOpt02C,b_AllOpt02D)

```
In the SomeOpt model, all expectations are violated except for cp_OffPSC7, which is positive and statistically significant, as expected.  All other variables display negative relationships, though only the invoice rate and percent PBSC are statistically significant as well.

In the AllOpt model, all expecatations are violated except for average salary, which now displays a positive and statistically significant relationship, as originally expected.  All other variables display negative relationships, though the invoice rate's effect is no longer statistically significant.  The effect of cp_OffPSC7 is particularly strong in magnitude (and is negative + stat. sig.).


## Office-Vendor Relationship

### 03A: Pair History
Expactation: As the number of past years of the relationship between the contracting office or the contractors with a single transaction in a given fiscal year enough to qualify, namely, pair history increases, we expect the likelihood of both some options being exercised and all options being exercised to increase.

```{r Model03A}

summary_discrete_plot(serv_opt,metric="opt","cn_PairHist7")


#Model
b_SomeOpt03A <- glm (data=serv_opt,
                 b_SomeOpt ~ cn_PairHist7, family=binomial(link="logit"))


b_AllOpt03A <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cn_PairHist7)


#Plot residuals versus fitted
  stargazer::stargazer(b_SomeOpt02D,b_SomeOpt03A,
                       
                       b_AllOpt02D,b_AllOpt03A,
                       type="text",
                       digits=2)



```
Expectations are violated in both models.


### 03B: Paired Actions
Expectation: As the number of contract actions a vendor has performed for an office in the past year increases (decreases), we expect the likelihood of both some options being exercised and all options being exercised to increase.

```{r Model03B}

summary_continuous_plot(serv_opt,metric="opt","cln_PairCA")

#Model
b_SomeOpt03B <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_PairCA, family=binomial(link="logit"))


b_AllOpt03B <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_PairCA)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt02D,b_SomeOpt03A,b_SomeOpt03B,
                       
                       b_AllOpt02D,b_AllOpt03A,b_AllOpt03B,
                       type="text",
                       digits=2)


```

Expectations are violated in both models.  Moreover, redisual plot for AllOpt model is questioanble (downward sloping straight line), and so we might want to question the validity of the result for this model.

### 03C: Office-Vendor Relationship
Expectation: 
The importance of partnership, trust, and handling difficult problems and uncertainty together naturally lead into the last characteristic: the relationship between the contractor and buyer. The higher level of interaction provides the more opportunity to build a deeper relationship, we expect the likelihood of both some options being exercised and all options being exercised to increase.

```{r Model03C}

#Model
b_SomeOpt03C <- glm (data=serv_opt,
                 b_SomeOpt ~ cn_PairHist7+cln_PairCA, family=binomial(link="logit"))
glmer_examine(b_SomeOpt03C)

b_AllOpt03C <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cn_PairHist7+cln_PairCA)

glmer_examine(b_AllOpt03C)

#Plot residuals versus fitted
  stargazer::stargazer(b_SomeOpt03A,b_SomeOpt03B,b_SomeOpt03C,
                       
                       b_AllOpt03A,b_AllOpt03B,b_AllOpt03C,
                       type="text",
                       digits=2)



summary_residual_compare(b_SomeOpt03A,b_SomeOpt03C,b_SomeOpt03B,b_SomeOpt03C)
summary_residual_compare(b_AllOpt03A,b_AllOpt03C,b_AllOpt03B,b_AllOpt03C)

```

Expectations are now partially me tin both models.  In both the SomeOpt and AllOpt model, pair history flips to displaying a positive, stat. sig. effect.  However, contract actions pair history remains negative and statistically significant.  In the AllOpt model case, it is very strongly negative.


### 03D: Cumulative  Model

Expectation: Under each subgroup, the predictors are expected to have similar impacts on dependent variables individually and cumulatively:
1. Higher Services Complexity: we expect the likelihood of both some options being exercised and all options being exercised to decrease
2. Larger Office Capacity: we expect the likelihood of both some options being exercised and all options being exercised to increase
3. Deeper Office-Vendor Relationship: we expect the likelihood of both some options being exercised and all options being exercised to increase

```{r Model03D}

#Model
b_SomeOpt03D <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA, family=binomial(link="logit"))
b_SomeOpt03Dv2 <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+
                 cn_PairHist7+cln_PairCA, family=binomial(link="logit"))
b_SomeOpt03Dv3 <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7, family=binomial(link="logit"))
glmer_examine(b_SomeOpt03D)
glmer_examine(b_SomeOpt03Dv2)
glmer_examine(b_SomeOpt03Dv3)
stargazer::stargazer(b_SomeOpt03Dv2, b_SomeOpt03Dv3, type = "text", digits = 2)

b_AllOpt03D <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7 + cp_OffPSC7+
                 cn_PairHist7+cln_PairCA)
b_AllOpt03Dv2 <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7 + 
                 cn_PairHist7+cln_PairCA)
b_AllOpt03Dv3 <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7 + cp_OffPSC7+
                 cn_PairHist7)

glmer_examine(b_AllOpt03D)
glmer_examine(b_AllOpt03Dv2)
glmer_examine(b_AllOpt03Dv3)
stargazer::stargazer(b_AllOpt03Dv2, b_AllOpt03Dv3, type = "text", digits = 2)

#Plot residuals versus fitted   

stargazer::stargazer(b_SomeOpt02D,b_SomeOpt03C,b_SomeOpt03D,
                       b_AllOpt02D,b_AllOpt03C,b_AllOpt03D,
                       type="text",
                       digits=2)


summary_residual_compare(b_SomeOpt03C,b_SomeOpt03D,b_SomeOpt02D,b_SomeOpt03D)
summary_residual_compare(b_AllOpt03C,b_AllOpt03D,b_AllOpt02D,b_AllOpt03D)

```
In both models, cln_PairCA (contract actions pair history) has an unacceptably high VIF: 2.31 in the SomeOpt model, and 2.18 in the AllOpt model.

For SomeOpt, we then create a new model including cln_PairCA, but dropping the variable with the second highest VIF score in the initial b_SomeOpt03D model, cp_OffPSC7.  In this model, b_SomeOpt03Dv2, all VIF scores are acceptable.  Similarly, we create another model, b_SomeOpt03Dv3, which includes all varibles except cln_PairCA, which again features acceptable VIF scores.  However, the AIC score of b_SomeOpt03Dv2 is lower than that of the model which does not include cln_PairCA, so we select b_SomeOpt03Dv2 as our operative model, and discuss the results here (i.e. we drop cp_OffPSC7 to avoid multicollinearity).  Results:
  (1) Higher service complexity variables - only invoice rate matches expectations, while average salary displays a positive and statistically significant effect.
  (2) Office capacity variables - percent PBSC does not meet expectations, as it shows a statistically significant, negative relationship.
  (3) Deeper office-vendor relationship variables - only pair history meets expectations, as contract actions pair history displays a statistically significant, strongly negative relationship.

A similar procedure is adopted for AllOpt, where again cp_OffPSC7 is dropped in model v2, whereas model v3 is a full specification not including cln_PairCA.  In both models, VIF scores are acceptable following drops, and again, model v2 displays a lower AIC score than model v3, and is so retained for our analysis.  Results:
  (1) Higher service complexity variables - no expectations met.  Average salary demonstrates a positive, stat. sig. effect.
  (2) Office capacity variables - percent PBSC does not meet expectations, as it shows a statistically significant, negative relationship.
  (3) Deeper office-vendor relationship variables - only pair history meets expectations, as contract actions pair history displays a statistically significant, negative relationship.

## Study Variables Alone

```{r StudyVariableAlone}


 study_coef_list<-get_coef_list(limit="services")

all_coef_list<-get_coef_list()

 
 
 
 
 


#Ceiling Breaches Binary
  stargazer::stargazer(b_SomeOpt01A,b_SomeOpt01B,b_SomeOpt02A,b_SomeOpt02B,b_SomeOpt03A,b_SomeOpt03B,b_SomeOpt03D,
                       type="text",
                       digits=2)



texreg::htmlreg(list(b_SomeOpt01A,b_SomeOpt01B,b_SomeOpt02A,b_SomeOpt02B,b_SomeOpt03A,b_SomeOpt03B,b_SomeOpt03D),file="..//Output//b_SomeOptModel.html",
                single.row = TRUE,
                # custom.model.name=c("Ceiling Breaches"),
                stars=c(0.1,0.05,0.01,0.001),
                groups = list(
                              "Services Complexity" = 2:3,
                              "Office Capacity" =4:5,
                              "Past Relationship"=6:7
                              ),
                custom.coef.map=all_coef_list,
                bold=0.05,
                custom.note="%stars. Numerical inputs are rescaled.",
                caption="Table 6: Logit Bivariate Look at Study Variables and Ceiling Breaches",
                caption.above=TRUE)




#Ceiling Breach Absolute
stargazer::stargazer(b_AllOpt01A,b_AllOpt01B,b_AllOpt02A,b_AllOpt02B,b_AllOpt03A,b_AllOpt03B,b_AllOpt03D,
                       type="text",
                       digits=2)


texreg::htmlreg(list(b_AllOpt01A,b_AllOpt01B,b_AllOpt02A,b_AllOpt02B,b_AllOpt03A,b_AllOpt03B,b_AllOpt03D),file="..//Output//b_AllOptModel.html",
                single.row = TRUE,
                # custom.model.name=c("Ceiling Breaches"),
                stars=c(0.1,0.05,0.01,0.001),
                groups = list(
                              "Services Complexity" = 2:3,
                              "Office Capacity" =4:5,
                              "Past Relationship"=6:7
                              ),
                custom.coef.map=all_coef_list,
                bold=0.05,
                custom.note="%stars. Numerical inputs are rescaled.",
                caption="Table 8: Regression Bivariate Look at Study Variables and Log(Options Growth)",
                caption.above=TRUE)





```

# Controls

##Contract-Level Controls
###Scope Variables
#### 04A: Cost Ceiling

Expectation: Initial Ceiling size positively estimates the probability of some options being exercised, while it should negatively estimate all otpions exercised.  Reasoning for this is straightforward: a higher initical ceiling indicates more options to be exercised/anticipated at contract start, which provides some indication that at least one option will be exercised, but equally means it is less likely for them all to be exercised purely for size reasons. 


```{r Model04A}

#Likelihood Plot for unlogged ceiling
summary_continuous_plot(serv_opt,metric="opt","UnmodifiedCeiling_OMB20_GDP18",bins=1000)
summary_continuous_plot(serv_opt,metric="opt","UnmodifiedCeiling_OMB20_GDP18",bins=50,log=TRUE)


#Model
b_SomeOpt04A <- glm (data=serv_opt,
                 b_SomeOpt ~ cl_Ceil, family=binomial(link="logit"))

b_AllOpt04A <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cl_Ceil)

#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt03D,b_SomeOpt04A,
                       
                       b_AllOpt03D,b_AllOpt04A,
                       type="text",
                       digits=2)

```
Expectations are met only for the SomeOpt model, as initial ceiling size displays a stat. sig., positive relationship in both models (violated expectations for the AllOpt model).  However, residual plot is wonky for AllOpt model (it appears quasi-sinusoidal), indicating we should be concerned about the validity of the AllOpt result.


#### 04B: Maximum Duration

Expectation: greater maximum duration is expected to positively estimate both b_SomeOpt and b_AllOpt.

```{r Model04B}
#Likelihood Plot for max duration
freq_continuous_cbre_plot(serv_opt,"UnmodifiedDays",
               bins=1000)

summary_continuous_plot(serv_opt,metric="opt","cln_Days")


#Model
b_SomeOpt04B <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_Days, family=binomial(link="logit"))

b_AllOpt04B <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_Days)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt03D,b_SomeOpt04A,b_SomeOpt04B,
                       
                       b_AllOpt03D,b_AllOpt04A,b_AllOpt04B,
                       type="text",
                       digits=2)

```

Expectations only met for SomeOpt model.  AllOpt model displays a very slightly negative relationship, but it is not statistically significant.

####04C: Ratio Initial Ceiling : Base Ratio (Logged)


Expectation, in combination with ceiling, a high ratio means that the contract has more room for adjustment and incentives without radical steps. For exercised options, a higher ratio is expected to make it more likely that some options are exercised but less likely that all options are exercised.
```{r Model04C}
summary_continuous_plot(serv_opt,metric="opt", "clr_Ceil2Base")

#Model


#Model
b_SomeOpt04C <- glm(data=serv_opt, b_SomeOpt ~ clr_Ceil2Base,family=binomial(link="logit"))

b_AllOpt04C <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ clr_Ceil2Base)


#Plot Residuals vs. Fitted
stargazer::stargazer(b_SomeOpt04A,b_SomeOpt04B,b_SomeOpt04C,
                     b_AllOpt04A,b_AllOpt04B,b_AllOpt04C, type="text", digits=2)



```
Expectations are met.

#### 04D: Ceiling-Days-Ratio

```{r Model04D}

#Model
b_SomeOpt04D <- glm (data=serv_opt,
                 b_SomeOpt ~ cl_Ceil + cln_Days + clr_Ceil2Base, family=binomial(link="logit"))
glmer_examine(b_SomeOpt04D)

b_AllOpt04D <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~cl_Ceil + cln_Days + clr_Ceil2Base)

glmer_examine(b_AllOpt04D)
#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt04A,b_SomeOpt04B,b_SomeOpt04C,b_SomeOpt04D,
                       type="text",
                       digits=2)
stargazer::stargazer(b_AllOpt04A,b_AllOpt04B,b_AllOpt04C,b_AllOpt04D,
                       type="text",
                       digits=2)


summary_residual_compare(b_SomeOpt04A,b_SomeOpt04D,b_SomeOpt04B,b_SomeOpt04D)
summary_residual_compare(b_AllOpt04A,b_AllOpt04D,b_AllOpt04B,b_AllOpt04D)
```
SomeOpt: Expectations met.
AllOpt: Some expectations met.  Ceiling to base ratio displays the expected negative, stat. significant, relationship.  However, initial ceiling size displays a postive, statistically significant effect (though only at the 10% level), and maximum contract length displays a statistically significant negative effect, both of which violate expectations.

#### 04E: Base
Expectation: higher base estimates a higher probability of b_SomeOpt, as larger projects have more momentum.
We weakly expect a higher base to estimate a lower probability of b_AllOpt.
```{r Model04E}

#Likelihood Plot for unlogged ceiling
summary_continuous_plot(serv_opt,metric="opt","UnmodifiedBase_OMB20_GDP18",bins=1000)
summary_continuous_plot(serv_opt,metric="opt","UnmodifiedBase_OMB20_GDP18",bins=50,log=TRUE)



#Model
b_SomeOpt04E <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_Base, family=binomial(link="logit"))

b_AllOpt04E <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_Base)

#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt03D,b_SomeOpt04A,b_SomeOpt04E,
                       b_AllOpt03D,b_AllOpt04A,b_AllOpt04E,
                       type="text",
                       digits=2)

#Including residual compare for base and counterpart ceiling
summary_residual_compare(b_SomeOpt04A,b_SomeOpt04E)
summary_residual_compare(b_AllOpt04A,b_AllOpt04E)


```
Expectations are met for b_SomeOpt, but not for b_AllOpt.

#### 04F: Base-Days-Ratio

```{r Model04F}

#Model
b_SomeOpt04F <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_Base+ cln_Days + clr_Ceil2Base, family=binomial(link="logit"))


b_AllOpt04F <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~cln_Base + cln_Days  + clr_Ceil2Base)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt04D,b_SomeOpt04E,b_SomeOpt04F,
                       
                       b_AllOpt04D,b_AllOpt04E,b_AllOpt04F,
                       type="text",
                       digits=2)



summary_residual_compare(b_SomeOpt04A,b_SomeOpt04F,b_SomeOpt04B,b_SomeOpt04F)
summary_residual_compare(b_AllOpt04A,b_AllOpt04F,b_AllOpt04B,b_AllOpt04F)
```
SomeOpt: Expectations met for days, ceiling to base ratio, and base itself.
AllOpt: Expectations not met for all variables.

#### 04G: Cumulative  Model

```{r Model04G}

#Model
b_SomeOpt04G <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days, family=binomial(link="logit"))
b_SomeOpt04Gv2 <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days, family=binomial(link="logit"))
b_SomeOpt04Gv3 <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7 +
                   cln_Base + clr_Ceil2Base + cln_Days, family=binomial(link="logit"))
glmer_examine(b_SomeOpt04G)
glmer_examine(b_SomeOpt04Gv2)
glmer_examine(b_SomeOpt04Gv3)
stargazer::stargazer(b_SomeOpt04Gv2, b_SomeOpt04Gv3, type = "text", digits = 2)

b_AllOpt04G <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7 + cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days)

glmer_examine(b_AllOpt04G)

#Plot residuals versus fitted   

stargazer::stargazer(b_SomeOpt03D,b_SomeOpt04F,b_SomeOpt04G,
                       
                       b_AllOpt03D,b_AllOpt04F,b_AllOpt04G,
                       type="text",
                       digits=2)


summary_residual_compare(b_SomeOpt03D,b_SomeOpt04G)
summary_residual_compare(b_AllOpt03D,b_AllOpt04G)


```
AllOpt: VIF score and residual plot acceptable.  Results:
  (1) Higher service complexity variables - invoice rate displays a negative, stat. sig., relationship, meeting expectations..  Average salary demonstrates a positive, stat. sig. effect.
  (2) Office capacity variables - neither variable meets expectations (though percent PBSC's negative effect is now no longer statistically significant).
  (3) Deeper office-vendor relationship variables - only pair history meets expectations, as contract actions pair history displays a statistically significant, negative relationship.
  (4) Control variables - No variables meet expectations
  
SomeOpt: VIF score of cln_PairCA unnaceptably high.  Two alternative models are created, b_SomeOpt04Gv2 and v3.  Model v2 drops cp_OffPSC7, the IV with the second highest VIF in model b_SomeOpt04.  Model v3 is a full specification without cln_PairCA.  VIF levels are acceptable for all variables in both model v2 and model v3.  AIC is lower for model v2, and so is selected for our analysis (i.e. we do our analysis with a model that drops cp_OffPSC7 and retains cln_PairCA).  Results:
  (1) Higher service complexity variables - expectations met for both variables
  (2) Office capacity variables - Percent PBSC does not meet expectations, as it displays a statiscally significant, negative relationship.
  (3) Deeper office-vendor relationship variables - only pair history meets expectations, as contract actions pair history displays a statistically significant, negative relationship.
  (4) Control variables - All variables meet expectations.


### Competition
#### 05A: No Competition / 1 / 2-4 / 5+ Offers
No competition (baseline) and single offer competition  is expected to estimate lower probabilities for both b_SomeOpt and b_AllOpt.

Multioffer competition is expected to lead to a higher probability of both b_SomeOpt and b_AllOpt for 2-4 options, but the opposite (i.e. lower probabilities for both) for 5+ as the diversity of competitors available may raise the appeal of going with a new contract rather than more options, especially if performance is below the desired level.

```{r Model05A}
summary_discrete_plot(serv_opt,metric="opt","Comp")


#Model
b_SomeOpt05A <- glm (data=serv_opt,
                 b_SomeOpt ~ Comp, family=binomial(link="logit"))


b_AllOpt05A <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ Comp)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt04G,b_SomeOpt05A,
                       
                       b_AllOpt04G,b_AllOpt05A,
                       type="text",
                       digits=2)




```
Expectations met for 1 offer binary.
Expectations not met for 2-4 offer binary - displays a statistically significant, negative relationship in both models.
Expectations met for 5+ offer binary (displays a stat. significant, negative relationship in both models).

#### 05B: Cumulative  Model

```{r Model05B}

#Model
b_SomeOpt05B <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days+
                   Comp, family=binomial(link="logit"))
b_SomeOpt05Bv2 <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days+
                   Comp, family=binomial(link="logit"))
b_SomeOpt05Bv3 <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7 +
                   cln_Base + clr_Ceil2Base + cln_Days+
                   Comp, family=binomial(link="logit"))
glmer_examine(b_SomeOpt05B)
glmer_examine(b_SomeOpt05Bv2)
glmer_examine(b_SomeOpt05Bv3)

stargazer::stargazer(b_SomeOpt05Bv2, b_SomeOpt05Bv3, type = "text", digits = 2)

#Is it safe to add pPBSC back in?

b_AllOpt05B <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp)

glmer_examine(b_AllOpt05B)

#Plot residuals versus fitted   

stargazer::stargazer(b_SomeOpt04G,b_SomeOpt05A,b_SomeOpt05B,
                       
                       b_AllOpt04G,b_AllOpt05A,b_AllOpt05B,
                       type="text",
                       digits=2)

 
summary_residual_compare(b_SomeOpt04G,b_SomeOpt05B)
summary_residual_compare(b_AllOpt04G,b_AllOpt05B)


```
AllOpt: VIF acceptable, residual plots acceptable.  Results:
  (1) Higher service complexity variables - invoice rate displays a negative, stat. sig., relationship, meeting expectations.  Average salary does not meet expectations.
  (2) Office capacity variables - neither variable meets expectations (though percent PBSC's negative effect is still not statistically significant).
  (3) Deeper office-vendor relationship variables - only pair history meets expectations, as contract actions pair history displays a statistically significant, negative relationship.
  (4) Control variables (base, ceiling to base ratio, maximum contract length) - No variables meet expectations
  (5) Number of offers variables - only Comp5+ offers meets expectations, the two other competition binaries do not have statistically significant effects.
  
SomeOpt: VIF of cln_PairCA unnaceptable.  Two alternative models are created, b_SomeOpt04Gv2 and v3.  Model v2 drops cp_OffPSC7, the IV with the second highest VIF in model b_SomeOpt04.  Model v3 is a full specification without cln_PairCA.  VIF levels are acceptable for all variables in both model v2 and model v3.  AIC is lower for model v2, and so is selected for our analysis.  Results:
  (1) Higher service complexity variables - expectations met for both variables
  (2) Office capacity variables - Percent PBSC does not meet expectations, as it displays a statiscally significant, negative relationship.
  (3) Deeper office-vendor relationship variables - only pair history meets expectations, as contract actions pair history displays a statistically significant, negative relationship.
  (4) Control variables (base, ceiling to base ratio, maximum contract length) - All variables meet expectations.
  (5) Number of offers variables - Comp1 offer and Comp5+ offer meet expectations.  Comp2-4 offers does not, as it displays a statistically significant, negative relationship.


### Contract Vehicle

#### 06A: Def/Pur; S-IDC; M-IDC; FSS-GWAC; BPA-BOA.

Expectation: Indefinite delivery vehicles, means that the government has an existing relationship with the vendor and administration is easier. The downside is that the government may be locked into the vendor. Excerised options not straightforward to puzzle through, but we expect a negative relationship as all forms of IDVs make it easier to use a new task order and thus may both reduce the need to exercise options and may allow new work to flow into a different contract rather than prompting a breach.


```{r Model06A}

summary_discrete_plot(serv_opt,metric="opt","Veh")


#Model
b_SomeOpt06A <- glm (data=serv_opt,
                 b_SomeOpt ~ Veh, family=binomial(link="logit"))


b_AllOpt06A <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ Veh)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt05B,b_SomeOpt06A,
                       
                       b_AllOpt05B,b_AllOpt06A,
                       type="text",
                       digits=2)




```
For ceiling breaches, IDCs, particularly multiaward IDCs, had a greater likelihood of  ceiling breaches contrary to expecations. For size the results were similarly mixed, with single award IDCS and BPA/BOAs estimating smaller  breaches in line with expetations and Mutiple Award and FSS/GWAC estimated larger breaches, contrary to expectation.

SomeOpt: VehS-IDC and VehBPA/BOA meet expectations.  Multiple award IDCs and FSS/GWAC vehicles both violate expectations, demonstrating statistically significant, positive relationships.

AllOpt: VehS-IDC, VehM-IDC, and VehBPA/BOA meet expectations.  FSS/GWAC vehicles do not meet expectations, but the positive effect they display is not statistically significant.


#### 06B: Cumulative  Model

```{r Model06B}

#Model
b_SomeOpt06B <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days+
                   Comp+
                   Veh, family=binomial(link="logit"))
b_SomeOpt06Bv2 <- glm (data=serv_opt,
                 b_SomeOpt ~ 
                   cln_PSCrate+ cp_OffPerf7+
                 cn_PairHist7 + clr_Ceil2Base + cln_Days+
                   Comp+
                   Veh, family=binomial(link="logit"))
glmer_examine(b_SomeOpt06B)
glmer_examine(b_SomeOpt06Bv2)

b_AllOpt06B <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh)
b_AllOpt06Bv2 <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~   
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh)
glmer_examine(b_AllOpt06B)
glmer_examine(b_AllOpt06Bv2) #Fine with cln_US6sal and cln_PairCA dropped

#Plot residuals versus fitted   

stargazer::stargazer(b_SomeOpt05B,b_SomeOpt06A,b_SomeOpt06B,
                       b_AllOpt05B,b_AllOpt06A,b_AllOpt06B,
                       type="text",
                       digits=2)


summary_residual_compare(b_SomeOpt05B,b_SomeOpt06B)
summary_residual_compare(b_AllOpt05B,b_AllOpt06B)


```
VIF score of vehicle in both models is unnaceptably large.  In order to reduce this to an acceptable level, a number of study variables would have to be dropped from the model, which the team found to be unacceptable.  Thus, vehicle is not included as a control in our cumulative model.

### Type of Contract

The next step adds a measure for whether the contract was cost-based or fixed-price. 

Expectation - prior CSIS research has found that fixed-price contracts estimate a higher probability of terminations but did not find a notable relationship for ceiling breaches.

#### 07A: FFP / Other FP / Incentive / T&M/FP:LOE;LH / Other CB / Combination

Firm-fixed price contracting is expected to be associated with a higher rate of options exercised, under both model specifications.

(Options, breach, termination)
Firm-Fixed Price (base)				+	+	++
Other Fixed Price				-	-	-
Time & Materials / Labor Hours / FP: LoE				-	+	-
Incentive Fee (both FPIF or CBIF)				+	-	-
Other Cost Based				-	-	-
Undefinitized Contract Award				--	++	++
Combination				-	+	+


```{r Model07A}
serv_opt$Pricing<-factor(serv_opt$Pricing,
                            levels=c( "FFP","Other FP","T&M/LH/FPLOE","Incentive","Other CB","UCA" ,"Combination or Other" ))
serv_opt$Pricing<-factor(serv_opt$Pricing,
                            levels=c( "FFP","Other FP","T&M/LH/FPLOE","Incentive","Other CB","UCA" ,"Combination or Other" ))
  summary_discrete_plot(serv_opt,metric="opt","Pricing")



#Model
b_SomeOpt07A <- glm (data=serv_opt,
                 b_SomeOpt ~ Pricing, family=binomial(link="logit"))


b_AllOpt07A <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ Pricing)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt06B,b_SomeOpt07A,
                       
                       b_AllOpt06B,b_AllOpt07A,
                       type="text",
                       digits=2)


```
For firm-fixed priced contracts, expectations are not met for both models (statistically significant negative relationship, where a positive relationship was expected).

For time and materials/labour hours/FP:LoE, expectations are not met (statistically significant positive relationship displayed) for both models.

For incentive-based contracts, expectations are met for both models.

For other cost-based pricing, expectations are not met for both models.

For undefinitized contract award-pricing, expectations are not met for both models, though a non-statistically significant negative relationship is displayed for the AllOpt model.

For combination-based pricing, expectations are not met for both models.


#### 07B: Cumulative  Model

```{r Model07B}

#Model
b_SomeOpt07B <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days+
                   Comp+
                   Pricing, family=binomial(link="logit"))
b_SomeOpt07Bv2 <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days+
                   Comp+
                   Pricing, family=binomial(link="logit"))
b_SomeOpt07Bv3 <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+
                   cln_Base + clr_Ceil2Base + cln_Days+
                   Comp+
                   Pricing, family=binomial(link="logit"))
glmer_examine(b_SomeOpt07B)
glmer_examine(b_SomeOpt07Bv2)
glmer_examine(b_SomeOpt07Bv3)

b_AllOpt07B <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Pricing)

glmer_examine(b_AllOpt07B)

#Plot residuals versus fitted   

stargazer::stargazer(b_SomeOpt06B,b_SomeOpt07A,b_SomeOpt07Bv3,
                       
                       b_AllOpt06B,b_AllOpt07A,b_AllOpt07B,
                       type="text",
                       digits=2)


summary_residual_compare(b_SomeOpt06B,b_SomeOpt07Bv3)
summary_residual_compare(b_AllOpt06B,b_AllOpt07B,bins=3)

```

AllOpt: VIF scores acceptable, residual plots within tolerance.  Results:
  (1) Higher service complexity variables - invoice rate displays a negative, stat. sig., relationship, meeting expectations.  Average salary does not meet expectations.
  (2) Office capacity variables - neither variable meets expectations (though percent PBSC's negative effect is only significant at the 5% level).
  (3) Deeper office-vendor relationship variables - only pair history meets expectations, as contract actions pair history displays a statistically significant, negative relationship.
  (4) Control variables (base, ceiling to base ratio, maximum contract length) - No variables meet expectations (and cln_Ceil2Base and cln_Days display statistically significant negative effects)
  (5) Number of offers variables - only Comp5+ offers meets expectations, while comp2-4 offers displays a statistically significant negative effect, the opposite of what was expected.
  (6) Pricing - For incentive-based contracts, expectations were met. They were not met for any other pricing variable - i.e.: For firm-fixed priced contracts, expectations were not met.  For time and materials/labour hours/FP:LoE, expectations are not met. For other cost-based pricing, expectations were not met.  For undefinitized contract award-pricing, expectations were not met.

SomeOpt: VIF score for cln_PairCA unacceptable.  Given that vehicle cannot be included as a control in this model, this document will assume that cln_PairCA is always going to have a multi-collinearity problem.  Following from the results of the analysis done when this problem has occurred in previous sections, we drop cp_OffPSC7 in b_SomeOpt07Bv2.  However, the VIF of cln_PairCA is still unacceptable.  In order to bring it within tolerance, we would have to drop a second study variable from our model, which, given that cln_PairCA violates our expectations and we were borderline between keeping it and retaining it when we only had to drop one explanatory variable, indicates that we should instead drop cln_PairCA.  This is done in b_SomeOptBv3, and will be done for the rest of the cumulative model specifications in this document for the b_SomeOpt models.  VIF is thus fine, residauls are slightly wonky, but tolerable, and so results:
  (1) Higher service complexity variables - expectations met for both variables
  (2) Office capacity variables - Only cp_OffPSC7 meets expectations.
  (3) Deeper office-vendor relationship variables -  pair history meets expectations (only variable in this category now)
  (4) Control variables (base, ceiling to base ratio, maximum contract length) - All variables meet expectations.
  (5) Number of offers variables - Comp1 offer and Comp5+ offer meet expectations.  Comp2-4 offers does not, as it displays a statistically significant, negative relationship.
  (6) Pricing - For incentive-based contracts, expectations were met. They were not met for any other pricing variable - i.e.: For firm-fixed priced contracts, expectations were not met.  For time and materials/labour hours/FP:LoE, expectations are not met. For other cost-based pricing, expectations were not met.  For undefinitized contract award-pricing, expectations were not met.


### Crisis Dataset
Expectation: Service Contract replying on crisis funds would have more likelihood of b_SomeOpp and b_AllOpp.
#### 08A: Crisis Funding
```{r Model08A}
summary_discrete_plot(serv_opt,metric="opt","Crisis")


#Model
b_SomeOpt08A <- glm (data=serv_opt,
                 b_SomeOpt ~ Crisis, family=binomial(link="logit"))


b_AllOpt08A <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ Crisis)



#Plot residuals versus fitted
#stargazer::stargazer(b_SomeOpt07B,b_SomeOpt08A,
                       
       #                b_AllOpt07B,b_AllOpt08A,
         #              type="text",
          #             digits=2)
stargazer::stargazer(b_SomeOpt08A, b_AllOpt08A, type = "text", digits = 2)

```
SomeOpt: No expectations met
AllOpt: Only CrisisARRA meets expectations, and is only statistically significant at the 10% level.


#### 08B: Cumulative  Model

```{r Model08B}

#Model
b_SomeOpt08B <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7 +
                   cln_Base + clr_Ceil2Base + cln_Days+
                   Comp+
                   Pricing+
                   Crisis, family=binomial(link="logit"))
glmer_examine(b_SomeOpt08B)

b_AllOpt08B <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Pricing+
                   Crisis)
b_AllOpt08Bv2 <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Pricing+
                   Crisis)
glmer_examine(b_AllOpt08B)
glmer_examine(b_AllOpt08Bv2)

#Plot residuals versus fitted   



stargazer::stargazer(b_SomeOpt07B,b_SomeOpt08A,b_SomeOpt08B,
                       
                       b_AllOpt07B,b_AllOpt08A,b_AllOpt08Bv2,
                       type="text",
                       digits=2)

summary_residual_compare(b_SomeOpt07B,b_SomeOpt08B)
summary_residual_compare(b_AllOpt07B,b_AllOpt08B)

```
AllOpt - at this point, cln_PairCA has an unacceptably high VIF.  Given the borderline nature of deciding to drop cln_PairCA vs cp_OffPSC7, I decide to drop cln_PairCA to stay in sync with the SomeOpt model.  This will be done for all future model specifications of the AllOpt model, and is done here as b_AllOpt08Bv2.  Rresiduals are acceptable, as are the VIF scores of this new model.  Results:
  (1) Higher service complexity variables - invoice rate displays a negative, stat. sig., relationship, meeting expectations.  Average salary does not meet expectations.
  (2) Office capacity variables - neither variable meets expectations (though percent PBSC's negative effect is only significant at the 5% level).
  (3) Deeper office-vendor relationship variables - pair history does not meet expectations.
  (4) Control variables (base, ceiling to base ratio, maximum contract length) - No variables meet expectations (and cln_Ceil2Base and cln_Days display statistically significant negative effects)
  (5) Number of offers variables - only Comp5+ offers meets expectations, while comp2-4 offers displays a statistically significant negative effect, the opposite of what was expected.
  (6) Pricing - For incentive-based contracts, expectations were met. They were not met for any other pricing variable - i.e.: For firm-fixed priced contracts, expectations were not met.  For time and materials/labour hours/FP:LoE, expectations are not met. For other cost-based pricing, expectations were not met.  For undefinitized contract award-pricing, expectations were not met.
  (7) Crisis funding - No expectations are met for any crisis funding variable. 

SomeOpt - Residuals are borderline, but acceptable.  VIF scores are well within tolerance.  Results:
  (1) Higher service complexity variables - expectations met for both variables
  (2) Office capacity variables - Only cp_OffPSC7 meets expectations.
  (3) Deeper office-vendor relationship variables -  pair history meets expectations (only variable in this category now)
  (4) Control variables (base, ceiling to base ratio, maximum contract length) - All variables meet expectations.
  (5) Number of offers variables - Only Comp5+ meets expectations.  Comp2-4 displays a statistically significant, negative relationship, opposite of expectations.
  (6) Pricing - Expectations only met for PricingUCA, and effect only statistically significant at the 10% level.  Expectations not met for any other pricing variable.

## Industrial Sector

### Level 6

#### Model 09A: cln_Def6HHI
(Options, breach, termination)
HHI (logged, + means more consolidation)	cln_Def6HHI+	-	+	-


Expectation: higher HHI means more consolidation, and thus is mor elikely to be associated with bad contracting outcomes.  IN turn, higher HHI should be associated with lower b_SomeOpt and b_AllOpt.
```{r Model09A}
#Likelihood Plot for unlogged ceiling
summary_continuous_plot(serv_opt,metric="opt","def6_HHI_lag1")
summary_continuous_plot(serv_opt,metric="opt","cln_Def6HHI")
summary_continuous_plot(serv_opt,metric="opt","cln_Def3HHI")


#Model
b_SomeOpt09A <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_Def6HHI, family=binomial(link="logit"))


b_AllOpt09A <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_Def6HHI)



#Plot residuals versus fitted
#stargazer::stargazer(b_SomeOpt08B,b_SomeOpt09A,b_AllOpt08B,b_AllOpt09A,type="text",digits=2)
stargazer::stargazer(b_SomeOpt09A,b_AllOpt09A,type="text",digits=2)

```

Expectations met.

#### Model 09B: Defense to Overall ratio
The higher the ratio of defense obligations to reciepts in the overall economy, the DoD holds a greater degree of monosopy over a sector. Given the challenges of monosopy, the a higher ratio estimates a higher probability of b_SomeOpt and b_AllOpt.

(Options, breach, termination)
Ratio Def. obligatons : US revenue	cln_Def6Obl+		+	-	-

```{r Model09B}
#Likelihood Plot for unlogged ceiling
      summary_continuous_plot(serv_opt,metric="opt","def6_ratio_lag1")

      summary_continuous_plot(serv_opt,metric="opt","clr_Def6toUS")
      



#Model
b_SomeOpt09B <- glm (data=serv_opt,
                 b_SomeOpt ~ clr_Def6toUS, family=binomial(link="logit"))


b_AllOpt09B <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ clr_Def6toUS)


#Plot residuals versus fitted
#stargazer::stargazer(b_SomeOpt08B,b_SomeOpt09A,b_SomeOpt09B,b_AllOpt08B,b_AllOpt09A,b_AllOpt09B,type="text", digits=2)
stargazer::stargazer(b_SomeOpt09A,b_SomeOpt09B,b_AllOpt09A,b_AllOpt09B,type="text", digits=2)



```
Expectations met for AllOpt, but not for SomeOpt, where clr_Def6toUS has a statistically significant, negative effect.

#### Model 09C: Defense Obligations
(Options, breach, termination)
Defense obligations (logged)	clr_Def6toUS+		-	-	+
Expectation: Higher logged defense obligations estimates lower probabilities for both b_SomeOpt and b_AllOpt.
```{r Model09C}
#Likelihood Plot for unlogged ceiling
      summary_continuous_plot(serv_opt,metric="opt","def6_obl_lag1Const")

      summary_continuous_plot(serv_opt,metric="opt","cln_Def6OblConst")
      
#Model
b_SomeOpt09C <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_Def6OblConst, family=binomial(link="logit"))


b_AllOpt09C <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_Def6OblConst)


#Plot residuals versus fitted
#stargazer::stargazer(b_SomeOpt09A,b_SomeOpt09B,b_SomeOpt09C, b_AllOpt09A,b_AllOpt09B,b_AllOpt09C,type="text",digits=2)
stargazer::stargazer(b_SomeOpt09A,b_SomeOpt09B,b_SomeOpt09C, b_AllOpt09A,b_AllOpt09B,b_AllOpt09C,type="text",digits=2)


```

Contrary to expectation. for ceiling breach frequecny and size.

#### Model 09D: NAICS6 6 Combined
Consolidation at less and more granular levels may have different effects. Efficiencies are often used to describe sectors, like utilities, with high barriers to entry. Many of these aspects seem like they would already be captured at less granular NAICS6 levels, e.g. power plants, rather than more specific NAICS6 levels, like solar vs. coal. As a result, consolidation for more granular NAICS6 codes should estimate higher rates of ceiling breaches compared to less granular NAICS6 code.

We'll start by adding in everything from both models and seeing what violates VIF.
```{r Model09D}
#Likelihood Plot for unlogged ceiling



#Model
b_SomeOpt09D <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_Def6HHI+clr_Def6toUS+cln_Def6OblConst
                 , family=binomial(link="logit"))
glmer_examine(b_SomeOpt09D)

b_AllOpt09D <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_Def6HHI+clr_Def6toUS+cln_Def6OblConst)

glmer_examine(b_AllOpt09D)

summary_residual_compare(b_SomeOpt09D, bins=10)
summary_residual_compare(b_AllOpt09D,bins=10)
```
The hypothesis is upheld. Deviance is a little lower and residuals a little higher than the prior forms of consolidation for the level 3 model.  For the level 6 model, deviance is reduced some in both cases.

Ratio at either level is no longer in line with expectations for ceiling breaches.

#### Model 09E: Cumulative Model
Consolidation at less and more granular levels may have different effects. Efficiencies are often used to describe sectors, like utilities, with high barriers to entry. Many of these aspects seem like they would already be captured at less granular NAICS6 levels, e.g. power plants, rather than more specific NAICS6 levels, like solar vs. coal. As a result, consolidation for more granular NAICS6 codes should estimate higher rates of ceiling breaches compared to less granular NAICS6 code.

We'll start by adding in everything from both models and seeing what violates VIF.
```{r Model09E}
#Model
b_SomeOpt09E <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days+
                   Comp+
                   Veh+
                   Pricing+
                   Crisis+
                   cln_Def6HHI+clr_Def6toUS+cln_Def6OblConst, family=binomial(link="logit"))
glmer_examine(b_SomeOpt09E)

b_AllOpt09E <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+cln_Def6OblConst)

glmer_examine(b_AllOpt09E)

#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt08B,b_SomeOpt09D,b_SomeOpt09E,
                     
                     b_AllOpt08B,b_AllOpt09D,b_AllOpt09E,
                       type="text",
                       digits=2)

summary_residual_compare(b_SomeOpt08B,b_SomeOpt09E)
summary_residual_compare(b_SomeOpt08B,b_SomeOpt09E)
```

Detailed Industry HHI is no longer significant for likelihood or size. Detailed Industry Ratio is now significant but now is associated with less frequent breaches, contrary to expectation. Detailed Industry Ratio remains in  ine with expectation tough with a smaller magnitude.

### Level 3
#### Model 10A: cln_Def3HHI
(Options, breaches, and terminations)
HHI (logged, + means more consolidation)	cln_Def3HHI		TRUE	-	+	++

```{r Model10A}
#Likelihood Plot for unlogged ceiling
summary_continuous_plot(serv_opt,metric="opt","cln_Def3HHI")

#Model
b_SomeOpt10A <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_Def3HHI, family=binomial(link="logit"))


b_AllOpt10A <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_Def3HHI)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt09A,b_SomeOpt10A,
                       
                       b_AllOpt09A,b_AllOpt10A,
                       type="text",
                       digits=2)

#Summary Residual Compare include for NAICS66 counterparts
summary_residual_compare(b_SomeOpt09A,b_SomeOpt10A, skip_vif =  TRUE)
summary_residual_compare(b_AllOpt09A,b_AllOpt10A, skip_vif =  TRUE)



```

The results for subsector HHI is contrary to expectation on Ceiling breach likelihood and size.

Level 3 HHI seems to slightly out perform level 6.


#### Model 10B: Defense to Overall ratio
(Options, breaches, and terminations)
Ratio Def. obligatons : US revenue	clr_Def3toUS+		-	+	+

```{r Model10B}
#Likelihood Plot for unlogged ceiling
summary_continuous_plot(serv_opt,metric="opt","capped_def3_ratio_lag1")
summary_continuous_plot(serv_opt,metric="opt","clr_Def3toUS")

#Model
b_SomeOpt10B <- glm (data=serv_opt,
                 b_SomeOpt ~ clr_Def3toUS, family=binomial(link="logit"))


b_AllOpt10B <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ clr_Def3toUS)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt09B,b_SomeOpt10A,b_SomeOpt10B,
                       
                       b_AllOpt09B,b_AllOpt10A,b_AllOpt10B,
                       type="text",
                       digits=2)

#Summary Residual Compare include for NAICS66 counterparts
summary_residual_compare(b_SomeOpt09B,b_SomeOpt10B)
summary_residual_compare(b_AllOpt09B,b_AllOpt10B)
```

Expectations were in lined with ceiling breach likelihood and size.


#### Model 10C: NAICS6 6 and NAICS6 3
Consolidation at lessa nd more granular levels may have different effects. Efficiencies are often used to describe sectors, like utilities, with high barriers to entry. Many of these aspects seem like they would already be captured at less granular NAICS6 levels, e.g. power plants, rather than more specific NAICS6 levels, like solar vs. coal. As a result, consolidation for more granular NAICS6 codes should estimate higher rates of ceiling breaches compared to less granular NAICS6 code.

We'll start by adding in everything from both models and seeing what violates VIF.
```{r Model10C}


#Model
b_SomeOpt10C <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_Def6HHI+clr_Def6toUS+cln_Def6OblConst+
                   cln_Def3HHI+clr_Def3toUS, family=binomial(link="logit"))
glmer_examine(b_SomeOpt10C)

b_AllOpt10C <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_Def6HHI+clr_Def6toUS+cln_Def6OblConst+
                   cln_Def3HHI+clr_Def3toUS)
glmer_examine(b_AllOpt10C)

#No obl
b_SomeOpt10C2 <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_Def6HHI+clr_Def6toUS+
                   cln_Def3HHI+clr_Def3toUS, family=binomial(link="logit"))
glmer_examine(b_SomeOpt10C2)

b_AllOpt10C2 <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_Def6HHI+clr_Def6toUS+
                   cln_Def3HHI+clr_Def3toUS)
glmer_examine(b_AllOpt10C2)

#No HHI6

b_SomeOpt10C3 <- glm (data=serv_opt,
                 b_SomeOpt ~ clr_Def6toUS+cln_Def6OblConst+
                   cln_Def3HHI+clr_Def3toUS, family=binomial(link="logit"))
glmer_examine(b_SomeOpt10C3)

b_AllOpt10C3 <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ clr_Def6toUS+cln_Def6OblConst+
                   cln_Def3HHI+clr_Def3toUS)
glmer_examine(b_AllOpt10C3)


#Model no ratio 3
b_SomeOpt10C4 <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_Def6HHI+clr_Def6toUS+cln_Def6OblConst+
                   cln_Def3HHI, family=binomial(link="logit"))
glmer_examine(b_SomeOpt10C4)

b_AllOpt10C4 <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_Def6HHI+clr_Def6toUS+cln_Def6OblConst+
                   cln_Def3HHI)
glmer_examine(b_AllOpt10C4)


#No Obl or subsector ratio
b_SomeOpt10C5 <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_Def6HHI+clr_Def6toUS+
                   cln_Def3HHI, family=binomial(link="logit"))
glmer_examine(b_SomeOpt10C5)

b_AllOpt10C5 <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_Def6HHI+clr_Def6toUS+
                   cln_Def3HHI)
glmer_examine(b_AllOpt10C5)

#No Obl or defense ratio
b_SomeOpt10C6 <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_Def6HHI+clr_Def6toUS+
                   clr_Def3toUS, family=binomial(link="logit"))
glmer_examine(b_SomeOpt10C6)

b_AllOpt10C6 <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_Def6HHI+clr_Def6toUS+
                   clr_Def3toUS)
glmer_examine(b_AllOpt10C6)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt09D,b_SomeOpt10A,b_SomeOpt10B,b_SomeOpt10C3,b_SomeOpt10C4,b_SomeOpt10C5,b_SomeOpt10C6,
                       type="text",
                       digits=2)

stargazer::stargazer(b_AllOpt09D,b_AllOpt10A,b_AllOpt10B,b_AllOpt10C3,b_AllOpt10C4,b_AllOpt10C5,b_AllOpt10C6,
                       type="text",
                       digits=2)


summary_residual_compare(b_SomeOpt10C3,b_SomeOpt10C4,b_SomeOpt10C5,b_SomeOpt10C6,bins=10)
summary_residual_compare(b_AllOpt10C3,b_AllOpt10C4,b_AllOpt10C5,b_AllOpt10C6,bins=10)
```

VIF is becoming a problem, prompting removal of detailed industry oligations, which is captured  in part by detailed industry ratio and the more on point measure of DoD experience, office volume. Unfortunately, this was not sufficient to lower VIFs below two, so defense ratio 3 was also removed.

Continuing with no detailed industry defense obligtions or subsector HHI for the time being.


#### Model 10D: Cumulative Model
.
```{r Model10D}
#Likelihood Plot for unlogged ceiling


#Model
b_SomeOpt10D <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days +
                   Comp+
                   Veh+
                   Pricing+
                   Crisis+
                   cln_Def6HHI+clr_Def6toUS+cln_Def3HHI+
                   clr_Def3toUS, family=binomial(link="logit"))
glmer_examine(b_SomeOpt10D)

b_AllOpt10D <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days +
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+cln_Def3HHI+
                   clr_Def3toUS)
glmer_examine(b_AllOpt10D)



#Model
b_SomeOpt10D2 <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days +
                   Comp+
                   Veh+
                   Pricing+
                   Crisis+
                   cln_Def6HHI+clr_Def6toUS+#cln_Def3HHI+
                   clr_Def3toUS, family=binomial(link="logit"))
glmer_examine(b_SomeOpt10D2)

b_AllOpt10D2 <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days +
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+#cln_Def3HHI+
                   clr_Def3toUS)
glmer_examine(b_AllOpt10D2)

#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt09E,b_SomeOpt10C6,b_SomeOpt10D,b_SomeOpt10D2,
                       type="text",
                       digits=2)
                     
stargazer::stargazer(b_AllOpt09E,b_AllOpt10C6,b_AllOpt10D,b_AllOpt10D2,
                       type="text",
                       digits=2)

summary_residual_compare(b_SomeOpt09E,b_SomeOpt10D)
summary_residual_compare(b_SomeOpt09E,b_SomeOpt10D)
```
For the breach size model, not adding HHI6 helps keep VIF below the 1.8 mark, with the exception of officePSC and also has a lower  AIC than the model that includid obligations const but not ratio. 


For likelihood, both ratio variables are contrary to expectation, but signifiant. Detailed industry HHI is not significant.
For size, Detailed  industry HHI has lost significance, bubt  both ratio variables retain it. 

## Office 
### Office and Vendor-Office Pair

#### Model 11A: Vendor Market Share
Expectation: Contracts of offices partnered with vendors who have larger market shares would be more likely to experience cost ceiling (++) breaches and exercised options, but less likely to have terminations.


```{r Model11A}

summary_continuous_plot(serv_opt,metric="opt","cp_PairObl7")


#Model
b_SomeOpt11A <- glm (data=serv_opt,
                 b_SomeOpt ~ cp_PairObl7, family=binomial(link="logit"))


b_AllOpt11A <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cp_PairObl7)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt11A,
                       b_AllOpt11A,
                       type="text",
                       digits=2)



```

Contrary to expetations for both likelihood and size.

#### Model 11B: Cumulative Model

```{r Model11B}
#Likelihood Plot for unlogged ceiling


#Model
b_SomeOpt11B <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days +
                   Comp+
                   Veh+
                   Pricing+
                   Crisis+
                   cln_Def6HHI+clr_Def6toUS+
                   #cln_Def3HHI+
                     clr_Def3toUS+
                   cp_PairObl7, family=binomial(link="logit"))
glmer_examine(b_SomeOpt11B)

b_AllOpt11B <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days +
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7)

glmer_examine(b_AllOpt11B)

#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt10D2,b_SomeOpt11A,b_SomeOpt11B,
                     
                     b_AllOpt10D2,b_AllOpt11A,b_AllOpt11B,
                       type="text",
                       digits=2)

summary_residual_compare(b_SomeOpt10D2,b_SomeOpt11B)
summary_residual_compare(b_AllOpt10D2,b_AllOpt11B)
```
Expectations are now upheld with market estimating larger ceiling breaches, although for likelihood, the magnitude increased in the opposite of the  expected direction.
### Other Office Characteristics
#### 12A: Past Office Volume (dollars)

Expectation: Contracting offices previously had more contract volume in dollars would have more experience managing cost and preventing cost-ceiling breaches, therefore larger past office volume would lower the likelihood of cost-ceiling breaches but no substantial relationships with likelihood of terminations or exercised options.
(Option, Breach, Termination)
Past Office Volume $s	cln_OffObl7		+	-	+
From looking at data, terminations, easier for big, less dependent. - less dependenct

```{r Model12A}

summary_continuous_plot(serv_opt,metric="opt","cln_OffObl7")

#Model
b_SomeOpt12A <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_OffObl7, family=binomial(link="logit"))


b_AllOpt12A <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_OffObl7)



#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt12A,
                       
                       b_AllOpt12A,
                       type="text",
                       digits=2)


```
When considering past office volume alone, the relationship was as expected with cost-ceiling breaches likelihood but contrary to expectation for breach size.



#### 12B: Detailed Industry Focus

Expectation: If a office is focused on a smaller number of industries than it has a less complex set of responsibilities which would decrease the likelihood of having cost ceiling breaches and terminations, and increase the likelihood of having options exercised.


```{r Model12B}
summary_continuous_plot(serv_opt,metric="opt","cln_OffFocus")


#Model
b_SomeOpt12B <- glm (data=serv_opt,
                 b_SomeOpt ~ cln_OffFocus, family=binomial(link="logit"))

b_AllOpt12B <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~ cln_OffFocus)


#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt12B,
                       
                       b_AllOpt12B,
                       type="text",
                       digits=2)

```

When using hhi calculated based on contracting office number of contarcts: results were contrary to expectations for likelihood but in line with expectations for size to expectations for size.

#### 12C: Cumulative Model

```{r Model12C}
#Likelihood Plot for unlogged ceiling


#Model
b_SomeOpt12C <- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days+
                   Comp+
                   Veh+
                   Pricing+
                   Crisis+
                   cln_Def6HHI+clr_Def6toUS+
                   #cln_Def3HHI+
                     clr_Def3toUS+
                   cp_PairObl7+
                   cln_OffObl7+cln_OffFocus , family=binomial(link="logit"))
glmer_examine(b_SomeOpt12C)

b_AllOpt12C <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+cln_OffFocus)

glmer_examine(b_AllOpt12C)

#Model
b_SomeOpt12C2<- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+#cp_OffPSC7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days+
                   Comp+
                   Veh+
                   Pricing+
                   Crisis+
                   cln_Def6HHI+clr_Def6toUS+
                   #cln_Def3HHI+
                     clr_Def3toUS+
                   cp_PairObl7+
                   cln_OffObl7+cln_OffFocus , family=binomial(link="logit"))
glmer_examine(b_SomeOpt12C2)

b_AllOpt12C2 <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+#cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+cln_OffFocus)

glmer_examine(b_AllOpt12C2)

#Model
b_SomeOpt12C3<- glm (data=serv_opt,
                 b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA +
                   cln_Base + clr_Ceil2Base + cln_Days+
                   Comp+
                   Veh+
                   Pricing+
                   Crisis+
                   cln_Def6HHI+clr_Def6toUS+
                   #cln_Def3HHI+
                     clr_Def3toUS+
                   cp_PairObl7+
                   cln_OffObl7#+cln_OffFocus 
                 , family=binomial(link="logit"))
glmer_examine(b_SomeOpt12C3)

b_AllOpt12C3 <- glm(data=serv_exeropt, family=binomial(link="logit"),
                        b_AllOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7#+cln_OffFocus
                   )

glmer_examine(b_AllOpt12C3)

#Plot residuals versus fitted
stargazer::stargazer(b_SomeOpt11B,b_SomeOpt12A,b_SomeOpt12B,b_SomeOpt12C2,b_SomeOpt12C3,
                       type="text",
                       digits=2)
                     
stargazer::stargazer(b_AllOpt11B,b_AllOpt12A,b_AllOpt12B,b_AllOpt12C2,b_AllOpt12C3,
                       type="text",
                       digits=2)

summary_residual_compare(b_SomeOpt11B,b_SomeOpt12C)
summary_residual_compare(b_AllOpt11B,b_AllOpt12C)
```
Detailed Industry Focus unfortunately runs into VIF problems with office PBSC for the breach size model. Keeping office focus in the breach size model  does not always align with expectations, but is  significant, is a study variable and has a lower AIC, so keeping it.

Office Volumne keeps its same significance and sign though pair history becomes insignificant, perhaps because offices with a great deal of volume had more history with momre vendors.

## Pre-Multilevel Model Summary

```{r StudyVariableSummary}


#Binary Ceiling Breaches
  stargazer::stargazer(b_SomeOpt01A,b_SomeOpt01B,b_SomeOpt02A,b_SomeOpt02B,b_SomeOpt03A,b_SomeOpt03B,b_SomeOpt03D,b_SomeOpt12C,
                       type="text",
                       digits=2)



texreg::htmlreg(list(b_SomeOpt01A,b_SomeOpt01B,b_SomeOpt02A,b_SomeOpt02B,b_SomeOpt03A,b_SomeOpt03B,b_SomeOpt03D,b_SomeOpt12C3),file="..//Output//b_SomeOptmodel_lvl1.html",
                single.row = TRUE,
                # custom.model.name=c("Ceiling Breaches"),
                stars=c(0.1,0.05,0.01,0.001),
                groups = list(
                              "Services Complexity" = 2:3,
                              "Office Capacity" =4:5,
                              "Past Relationship"=6:7
                              ),
                custom.coef.map=study_coef_list,
                bold=0.05,
                custom.note="%stars. Numerical inputs are rescaled.",
                caption="Table 6: Logit Bivariate Look at Study Variables and Ceiling Breaches",
                caption.above=TRUE)


#Absolute Size Ceiling Breaches
stargazer::stargazer(b_AllOpt01A,b_AllOpt01B,b_AllOpt02A,b_AllOpt02B,b_AllOpt03A,b_AllOpt03B,b_AllOpt03D,b_AllOpt12C3,
                       type="text",
                       digits=2)


texreg::htmlreg(list(b_AllOpt01A,b_AllOpt01B,b_AllOpt02A,b_AllOpt02B,b_AllOpt03A,b_AllOpt03B,b_AllOpt03D,b_AllOpt12C3),file="..//Output//b_AllOptmodel_lvl1.html",
                single.row = TRUE,
                # custom.model.name=c("Ceiling Breaches"),
                stars=c(0.1,0.05,0.01,0.001),
                groups = list(
                              "Services Complexity" = 2:3,
                              "Office Capacity" =4:5,
                              "Past Relationship"=6:7
                              ),
                custom.coef.map=study_coef_list,
                bold=0.05,
                custom.note="%stars. Numerical inputs are rescaled.",
                caption="Table 8: Regression Bivariate Look at Study Variables and Log(Options Growth)",
                caption.above=TRUE)





```


####15A: Average U.S. Salaries (logged):Contract Pricing
Cost-based and incentive contract types may do a  better job at handling complex contracts.

```{r Model15A}
#Create the models
b_SomeOpt_salary_pricing_15A_no_interact <- glm(data=serv_opt, b_SomeOpt ~ Pricing + cl_US6_avg_sal_lag1, 
                                             family=binomial(link="logit"))
glmer_examine(b_SomeOpt_salary_pricing_15A_no_interact)

b_SomeOpt_salary_pricing_15A <- glm(data=serv_opt, b_SomeOpt ~ Pricing + cl_US6_avg_sal_lag1 + Pricing:cl_US6_avg_sal_lag1,
                                 family=binomial(link="logit"))
glmer_examine(b_SomeOpt_salary_pricing_15A)


b_AllOpt_salary_pricing_15A_no_interact <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ Pricing + cl_US6_avg_sal_lag1)
glmer_examine(b_AllOpt_salary_pricing_15A_no_interact)

b_AllOpt_salary_pricing_15A <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ Pricing + cl_US6_avg_sal_lag1 + Pricing:cl_US6_avg_sal_lag1)
glmer_examine(b_AllOpt_salary_pricing_15A)


#compare the models

stargazer::stargazer(b_SomeOpt_salary_pricing_15A_no_interact, b_SomeOpt_salary_pricing_15A, 
                     b_AllOpt_salary_pricing_15A_no_interact, b_AllOpt_salary_pricing_15A, type="text", digits=2)

summary_residual_compare(b_SomeOpt_salary_pricing_15A_no_interact, b_SomeOpt_salary_pricing_15A, bins=5)
summary_residual_compare(b_AllOpt_salary_pricing_15A_no_interact, b_AllOpt_salary_pricing_15A, bins=5)

```
For likelihood expectations are only partially hold, predominately for other cost based and combination or other. For size, expectations are widely upheld, except UCA contracts which are a special case of cost absed. 
####15B: Cumulative
```{r Model15B}
#Create the model
b_SomeOpt_salary_pricing_15B <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+ 
                 Pricing:cl_US6_avg_sal_lag1, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_salary_pricing_15B)

b_AllOpt_salary_pricing_15B <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   Pricing:cl_US6_avg_sal_lag1)
glmer_examine(b_AllOpt_salary_pricing_15B)

```
Maximum VIF greatly exceeds 2 in both cases.



####16A: Office Partnership:Actions
Performance based contracting should  encourage higher communication interactions and allow for more flexability, potentially increasing the benefits of regular interaction.
(Options, Breach, Terminations)
Interact: Actions	cp_OffPerf7:cln_PairCA			+	-	-

```{r Model16A}
#Create the models

b_SomeOpt_partnership_actions_16A_no_interact <- glm(data=serv_opt, b_SomeOpt ~ cp_OffPerf7 + cln_PairCA, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_partnership_actions_16A_no_interact)

b_SomeOpt_partnership_actions_16A <- glm(data=serv_opt, b_SomeOpt ~ cp_OffPerf7 + cln_PairCA + cp_OffPerf7:cln_PairCA, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_partnership_actions_16A)


#compare the models

b_AllOpt_partnership_actions_16A_no_interact <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cp_OffPerf7 + cln_PairCA)
glmer_examine(b_AllOpt_partnership_actions_16A_no_interact)

b_AllOpt_partnership_actions_16A <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cp_OffPerf7 + cln_PairCA + cp_OffPerf7:cln_PairCA)
glmer_examine(b_AllOpt_partnership_actions_16A)


stargazer::stargazer(b_SomeOpt_partnership_actions_16A_no_interact, b_SomeOpt_partnership_actions_16A, 
                     b_AllOpt_partnership_actions_16A_no_interact, b_AllOpt_partnership_actions_16A, type="text", digits=2)

summary_residual_compare(b_SomeOpt_partnership_actions_16A_no_interact, b_SomeOpt_partnership_actions_16A, bins=3)

summary_residual_compare(b_AllOpt_partnership_actions_16A_no_interact, b_AllOpt_partnership_actions_16A, bins=3)

```
The interaction was signiicant in both cases but positive and contrary to expectations for likelihood and negative and in keeping with expectations for breach size. That said for likelihood  the introduction of the interaction does result in pairCA switching to a negative sign which is in keeping with expectations. Seems worth considering adding in both cases.
####16B: Cumulative
```{r Model16B}
#Create the model
b_SomeOpt_partnership_actions_16B <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+ 

                 cp_OffPerf7:cln_PairCA, family=binomial(link="logit"))


b_AllOpt_partnership_actions_16B <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cl_office_NAICS6_hhi_kc+
                   cp_OffPerf7:cln_PairCA)


#Compare the models
stargazer::stargazer(b_SomeOpt12C3, b_SomeOpt_partnership_actions_16B, 
                     b_AllOpt12C3, b_AllOpt_partnership_actions_16B, type="text", digits=2)

summary_residual_compare(b_SomeOpt12C3, b_SomeOpt_partnership_actions_16B)
summary_residual_compare(b_AllOpt12C3, b_AllOpt_partnership_actions_16B)
```

The results were similar to those of the isolated models. Doesn't seem to worsen residuals and greatly helps AIC. Adding in both cases, despite being positive contrary to expectations for b_SomeOpt.

Current cumulative b_SomeOpt model: b_SomeOpt_partnership_actions_16B
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B

####17A: Office Partnership:Market Vendor Share for that Office
Performance based contracting is thought to mitigte some of the risks of vendor  lock.
(option,breach,termination)
Interact: Market Share Vendor for that Office	cp_OffPerf7: cp_PairObl7			++	--	--

```{r Model17A}
#Define the models

b_SomeOpt_partnership_share_17A_no_interact <- glm(data=serv_opt, b_SomeOpt ~ cp_OffPerf7 + cp_PairObl7, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_partnership_share_17A_no_interact)

b_SomeOpt_partnership_share_17A <- glm(data=serv_opt, b_SomeOpt ~ cp_OffPerf7 + cp_PairObl7 + cp_OffPerf7:cp_PairObl7, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_partnership_share_17A)

b_AllOpt_partnership_share_17A_no_interact <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cp_OffPerf7 + cp_PairObl7)
glmer_examine(b_AllOpt_partnership_share_17A_no_interact)

b_AllOpt_partnership_share_17A <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cp_OffPerf7 + cp_PairObl7 + cp_OffPerf7:cp_PairObl7)
glmer_examine(b_AllOpt_partnership_share_17A)


#Compare the models
stargazer::stargazer(b_SomeOpt_partnership_share_17A_no_interact, b_SomeOpt_partnership_share_17A, 
                     b_AllOpt_partnership_share_17A_no_interact, b_AllOpt_partnership_share_17A, type="text", digits=2)

summary_residual_compare(b_SomeOpt_partnership_share_17A_no_interact, b_SomeOpt_partnership_share_17A)
summary_residual_compare(b_AllOpt_partnership_share_17A_no_interact, b_AllOpt_partnership_share_17A)
```
Positive, contrary to expectation in both cases. No clear benefit in the residuals.
####17B: Cumulative
```{r Model17B}
#Create the model
b_SomeOpt_partnership_share_17B <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+ 
                 cp_OffPerf7:cln_PairCA+cp_OffPerf7:cp_PairObl7, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_partnership_share_17B)

b_SomeOpt_partnership_share_17B2 <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+ 
                 #cp_OffPerf7:cln_PairCA+
                   cp_OffPerf7:cp_PairObl7, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_partnership_share_17B2)


b_AllOpt_partnership_share_17B <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   cp_OffPerf7:cln_PairCA+cp_OffPerf7:cp_PairObl7)
glmer_examine(b_AllOpt_partnership_share_17B)


b_AllOpt_partnership_share_17B2 <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   cp_OffPerf7:cp_PairObl7)
glmer_examine(b_AllOpt_partnership_share_17B2)

#Compare the models
stargazer::stargazer(b_SomeOpt_partnership_actions_16B, b_SomeOpt_partnership_share_17B, b_SomeOpt_partnership_share_17B2,
                     b_AllOpt_partnership_actions_16B, b_AllOpt_partnership_share_17B2, type="text", digits=2)

summary_residual_compare(b_SomeOpt_partnership_actions_16B, b_SomeOpt_partnership_share_17B)
summary_residual_compare(b_AllOpt_partnership_actions_16B, b_AllOpt_partnership_share_17B2)
```
For likelihood, it negative in alignment with expectations, does prompt a small reduction in AIC and thus seems worth adding.

For size, VIF violations preclude allowing both PBSC:pairCA and PBSC and p_Mark for likelihood. PBSC:pairCA is in line with expectations and has a lower AIC, so is clearly the one to keep.


Current cumulative b_SomeOpt model: b_SomeOpt_partnership_share_17B
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B


####17C: Office Volume:Market Vendor Share for that Office
A small office heavily reliant on a single vendor may just be practical consolidation of contract. For a large office, said primacy is more noteworthy and may indicate vendor lock-in. In keeping with p_Market as a whole this may mean more options exercised and fewer terminations  given the absence of other choices. However, a greater likelihood of ceiling breaches and a greater size of ceiling breaches is the expected donside.

(option,breach,termination)
Interact: Office Volume cln_OffObl7: cp_PairObl7		+	+	-


```{r Model17A}
#Define the models


b_SomeOpt17C_no_interact <- glm(data=serv_opt, b_SomeOpt ~ cln_OffObl7 + cp_PairObl7, family=binomial(link="logit"))
glmer_examine(b_SomeOpt17C_no_interact)

b_SomeOpt17C <- glm(data=serv_opt, b_SomeOpt ~ cln_OffObl7 + cp_PairObl7 + cln_OffObl7:cp_PairObl7, family=binomial(link="logit"))
glmer_examine(b_SomeOpt17C)

b_AllOpt17C_no_interact <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_OffObl7 + cp_PairObl7)
glmer_examine(b_AllOpt17C_no_interact)

b_AllOpt17C <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_OffObl7 + cp_PairObl7 + cln_OffObl7:cp_PairObl7)
glmer_examine(b_AllOpt17C)


#Compare the models
stargazer::stargazer(b_SomeOpt17C_no_interact, b_SomeOpt17C, 
                     b_AllOpt17C_no_interact, b_AllOpt17C, type="text", digits=2)

summary_residual_compare(b_SomeOpt17C_no_interact, b_SomeOpt17C)
summary_residual_compare(b_AllOpt17C_no_interact, b_AllOpt17C)
```
The interaction significantly estimated a lower likelihood of ceiling breaches, contrary to expectation. However for size the interaction estimated significantly larger breaches with 
####17D: Cumulative
```{r Model17D}
#Create the model
b_SomeOpt17D <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 cln_OffFocus+
                 cp_OffPerf7:cln_PairCA+
                   cp_OffPerf7:cp_PairObl7+cln_OffObl7:cp_PairObl7, family=binomial(link="logit"))
glmer_examine(b_SomeOpt17D)


b_AllOpt17D <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   cp_OffPerf7:cln_PairCA+
                   cln_OffObl7:cp_PairObl7)
glmer_examine(b_AllOpt17D)


b_AllOpt17D2 <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   # cp_OffPerf7:cln_PairCA+
                   cln_OffObl7:cp_PairObl7)
glmer_examine(b_AllOpt17D2)


#Compare the models
stargazer::stargazer(b_SomeOpt_partnership_share_17B2, b_SomeOpt17D, b_SomeOpt17D,
                     b_AllOpt_partnership_actions_16B, b_AllOpt17D2, type="text", digits=2)


stargazer::stargazer(b_SomeOpt_partnership_actions_16B, b_SomeOpt_partnership_share_17B, b_SomeOpt_partnership_share_17B2,
                     b_AllOpt_partnership_actions_16B, b_AllOpt_partnership_share_17B2, type="text", digits=2)


summary_residual_compare(b_SomeOpt_partnership_actions_16B, b_SomeOpt17D)
summary_residual_compare(b_AllOpt_partnership_actions_16B, b_AllOpt17D2)
```

Significant negative estimate of likelihood is contrary to expectation. Significant positive estimate of breach size is in line with expectations but to avoid multicollinearity requires removing cp_OffPerf7:cln_PairCA. However, the model with cp_OffPerf7:cln_PairCA has a lower AIC and is relevant  to  a study variable. Leaving this interaction out.

Current cumulative b_SomeOpt model: b_SomeOpt_partnership_share_17B
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B


####18A: Office Partnership:Initial Contract Duration (logged)
Performance  based contracting is thought to mitigate the risks of longer time horizons and may even work  better with  them by incentivizing vendor investments.
(option, breach, term)
Interact: Initial Contract Duration (logged)	cp_OffPerf7: capped_cln_Days			++	--	--

```{r Model18A}
#Create the Model
b_SomeOpt_partnership_duration_18A_no_interact <- glm(data=serv_opt , b_SomeOpt ~ cp_OffPerf7 + cln_Days, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_partnership_duration_18A_no_interact)

b_SomeOpt_partnership_duration_18A <- glm(data=serv_opt, b_SomeOpt ~ cp_OffPerf7 + cln_Days + cp_OffPerf7: cln_Days, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_partnership_duration_18A)

b_AllOpt_partnership_duration_18A_no_interact <- glm(data=serv_breach , b_AllOpt ~ cp_OffPerf7 + cln_Days)
glmer_examine(b_AllOpt_partnership_duration_18A_no_interact)

b_AllOpt_partnership_duration_18A <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cp_OffPerf7 + cln_Days + cp_OffPerf7: cln_Days)
glmer_examine(b_AllOpt_partnership_duration_18A)

#Compare the models
stargazer::stargazer(b_SomeOpt_partnership_duration_18A_no_interact, b_SomeOpt_partnership_duration_18A, 
                     b_AllOpt_partnership_duration_18A_no_interact, b_AllOpt_partnership_duration_18A,
                     type="text", digits=2)

summary_residual_compare(b_SomeOpt_partnership_duration_18A_no_interact, b_SomeOpt_partnership_duration_18A)
summary_residual_compare(b_AllOpt_partnership_duration_18A_no_interact, b_AllOpt_partnership_duration_18A)
```
The results are siginificant, negative, and align with expectations in both cases.  The maginitude of the coeefficient and reduction in AIC is notably larger for likelihood than for size, but both seem worth considering.
####18B: Cumulative
```{r Model18B}
#Create the model
b_SomeOpt_partnership_duration_18B <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                 cp_OffPerf7:cln_PairCA+cp_OffPerf7:cp_PairObl7+
                 cp_OffPerf7:cln_Days, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_partnership_duration_18B)

b_AllOpt_partnership_duration_18B <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   cp_OffPerf7:cln_PairCA+
                   cp_OffPerf7:cln_Days)
glmer_examine(b_AllOpt_partnership_duration_18B)

b_AllOpt_partnership_duration_18B2 <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   # cp_OffPerf7:cln_PairCA+
                   cp_OffPerf7:cln_Days)
glmer_examine(b_AllOpt_partnership_duration_18B2)


#Compare the models
stargazer::stargazer(b_SomeOpt_partnership_share_17B, b_SomeOpt_partnership_duration_18B, 
                     b_AllOpt_partnership_actions_16B, b_AllOpt_partnership_duration_18B2, type="text", digits=2)

summary_residual_compare(b_SomeOpt_partnership_share_17B, b_SomeOpt_partnership_duration_18B)
summary_residual_compare(b_AllOpt_partnership_actions_16B, b_AllOpt_partnership_duration_18B2)
```
For frequeny, the results are significant andin  line with expectations. For sign the results violate VIF requiring the removal of cp_OffPerf7:cln_PairCA to procede. The coeficient for the cp_OffPerf7:cln_Days in the resulting model is not significant and has a AIC notably than for the prior model. The interaction will be added for likelihood but not size.

Current cumulative b_SomeOpt model: b_SomeOpt_partnership_duration_18B
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B


####19A: Past Years:Contract Pricing
Positive prior relationships increase the effectiveness of cost-based contracts. T&M / LH / FP: LoE are in the middle here, so leaving  them out.

(Option, Breach,Term)
Firm-Fixed Price (base)				-	+	+
Other Fixed Price				-	+	+
Time & Materials / Labor Hours / FP: LoE						
Incentive Fee (both FPIF or CBIF)				++	--	--
Other Cost Based				+	-	-
Undefinitized Contract Award				+	-	-
Combination				+	-	-
```{r Model19A}
#Create the models
b_SomeOpt_history_pricing_19A_no_interact <- glm(data=serv_opt, b_SomeOpt ~ cn_PairHist7 + Pricing, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_history_pricing_19A_no_interact)

b_SomeOpt_history_pricing_19A <- glm(data=serv_opt, b_SomeOpt ~ cn_PairHist7 + Pricing + cn_PairHist7:Pricing, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_history_pricing_19A)

b_AllOpt_history_pricing_19A_no_interact <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cn_PairHist7 + Pricing)
glmer_examine(b_AllOpt_history_pricing_19A_no_interact)

b_AllOpt_history_pricing_19A <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cn_PairHist7 + Pricing + cn_PairHist7:Pricing)
glmer_examine(b_AllOpt_history_pricing_19A)


#Compare the models
stargazer::stargazer(b_SomeOpt_history_pricing_19A_no_interact, b_SomeOpt_history_pricing_19A,
                     b_AllOpt_history_pricing_19A_no_interact, b_AllOpt_history_pricing_19A,
                     type="text", digits=2)

summary_residual_compare(b_SomeOpt_history_pricing_19A_no_interact, b_SomeOpt_history_pricing_19A)
summary_residual_compare(b_AllOpt_history_pricing_19A_no_interact, b_AllOpt_history_pricing_19A)

```
For likelihood the results are negative in line with expectations hold for other CA and combination or other but not for incentive. For size the results are largely out of line with expectations at all.
####19B: Cumulative
```{r Model19B}
#Create the model
b_SomeOpt_history_pricing_19B <- glm(data=serv_opt,
                                  b_SomeOpt ~  cln_US6sal + 
                                    cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                                    cn_PairHist7+cln_PairCA+
                                    cln_Base + clr_Ceil2Base + cln_Days+
                                    Comp+
                                    Veh+
                                    Pricing+
                                    Crisis+
                                    cln_Def6HHI+clr_Def6toUS+
                                    #cln_Def3HHI+
                                    clr_Def3toUS+
                                    cp_PairObl7+
                                    cln_OffObl7+ 
                                    #cln_OffFocus+ 
                                    cp_OffPerf7:cln_PairCA+cp_OffPerf7:cp_PairObl7+
                                    cp_OffPerf7:cln_Days+
                                    cn_PairHist7:Pricing, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_history_pricing_19B)

b_AllOpt_history_pricing_19B <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   cp_OffPerf7:cln_PairCA+
                   cn_PairHist7:Pricing)
glmer_examine(b_AllOpt_history_pricing_19B)

b_AllOpt_history_pricing_19B2 <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   # cp_OffPerf7:cln_PairCA+
                   cn_PairHist7:Pricing)
glmer_examine(b_AllOpt_history_pricing_19B2)


#Compare the models
stargazer::stargazer(b_SomeOpt_partnership_duration_18B, b_SomeOpt_history_pricing_19B,
                     b_AllOpt_partnership_actions_16B, b_AllOpt_history_pricing_19B2, type="text", digits=2)

summary_residual_compare(b_SomeOpt_partnership_duration_18B, b_SomeOpt_history_pricing_19B)
summary_residual_compare(b_AllOpt_partnership_actions_16B, b_AllOpt_history_pricing_19B2)
```
For likelihood the results are insignificant and in line with expectations for other cost based but are otherwise not significant at the 0.05 level or contrary to expectations. Leaving it out. For breach size, VIF exceeded 2 for the initial model requiring consideration without the other  interaction in place. c_PBSC and cln_PairCA has the advantage of having both base variables e significant and a lower AIC. The residuals are smaller for past years:pricing but show more of a sinusodial pattern. Leaving this out for size as well.

Current cumulative b_SomeOpt model: b_SomeOpt_partnership_duration_18B
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B


####20A: Competition:NAICS6 Detailed Industry (Level 6)
If competition is an instrument for consolidation, than it should be most effective when consolidation is lower.

(Option, Breach,Term)
No Competition (Baseline)				-	++	-
1 Offer:				-	+	-
2-4 Offers				+	-	+
5+ Offers				-	-	+
```{r Model20A}
#Create the models
#NAICS66 Detailed Industry
b_SomeOpt_competition_NAICS66_20A_no_interact <- glm(data=serv_opt, b_SomeOpt ~ Comp + cln_Def6HHI, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_competition_NAICS66_20A_no_interact)

b_SomeOpt_competition_NAICS66_20A <- glm(data=serv_opt, b_SomeOpt ~ Comp + cln_Def6HHI + Comp:cln_Def6HHI, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_competition_NAICS66_20A)

b_AllOpt_competition_NAICS66_20A_no_interact <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ Comp + cln_Def6HHI)
glmer_examine(b_AllOpt_competition_NAICS66_20A_no_interact)

b_AllOpt_competition_NAICS66_20A <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ Comp + cln_Def6HHI + Comp:cln_Def6HHI)
glmer_examine(b_AllOpt_competition_NAICS66_20A)

#NAICS3 Subsector
b_SomeOpt_competition_NAICS66_20A_no_interact <- glm(data=serv_opt, b_SomeOpt ~ Comp + cln_Def3HHI, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_competition_NAICS66_20A_no_interact)

b_SomeOpt_competition_NAICS66_20A <- glm(data=serv_opt, b_SomeOpt ~ Comp + cln_Def3HHI + Comp:cln_Def3HHI, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_competition_NAICS66_20A)

b_AllOpt_competition_NAICS66_20A_no_interact <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ Comp + cln_Def3HHI)
glmer_examine(b_AllOpt_competition_NAICS66_20A_no_interact)

b_AllOpt_competition_NAICS66_20A <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ Comp + cln_Def3HHI + Comp:cln_Def3HHI)
glmer_examine(b_AllOpt_competition_NAICS66_20A)


```
The interaction models consistently exceed VIF with both NAICS66 and NAICS3 HHI
####20B: Cumulative
```{r Model20B}
#Create the model
#NAICS66 Detailed Industry
b_SomeOpt_competition_NAICS66_20B <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+ 
                                  cp_OffPerf7:cln_PairCA+cp_OffPerf7:cp_PairObl7+
                 cp_OffPerf7:cln_Days+
                   Comp:cln_Def6HHI, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_competition_NAICS66_20B)

b_SomeOpt_competition_NAICS66_20B2 <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+ 
                                  # cp_OffPerf7:cln_PairCA+cp_OffPerf7:cp_PairObl7+
                 # cp_OffPerf7:cln_Days+
                   Comp:cln_Def6HHI, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_competition_NAICS66_20B2)

b_AllOpt_competition_NAICS66_20B <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   cp_OffPerf7:cln_PairCA+
                   Comp:cln_Def6HHI)
glmer_examine(b_AllOpt_competition_NAICS66_20B)

b_AllOpt_competition_NAICS66_20B2 <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   # cp_OffPerf7:cln_PairCA+
                   Comp:cln_Def6HHI)
glmer_examine(b_AllOpt_competition_NAICS66_20B2)

#NAICS3 Subsector
b_SomeOpt_competition_naincs3_20B <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+ 
                                  cp_OffPerf7:cln_PairCA+cp_OffPerf7:cp_PairObl7+
                 cp_OffPerf7:cln_Days+
                   Comp:cln_Def6HHI, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_competition_naincs3_20B)

b_SomeOpt_competition_naincs3_20B2 <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+ 
                                  # cp_OffPerf7:cln_PairCA+cp_OffPerf7:cp_PairObl7+
                 # cp_OffPerf7:cln_Days+
                   Comp:cln_Def6HHI, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_competition_naincs3_20B2)

b_AllOpt_competition_naincs3_20B <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   cp_OffPerf7:cln_PairCA+
                   Comp:cln_Def6HHI)
glmer_examine(b_AllOpt_competition_naincs3_20B)

b_AllOpt_competition_naincs3_20B2 <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   # cp_OffPerf7:cln_PairCA+
                   Comp:cln_Def6HHI)
glmer_examine(b_AllOpt_competition_naincs3_20B2)

```
For all HHI6 and HHI3 models, VIF is exceeded even with removal of other interaction terms.

####21A: Ratio Initial Base to Ceiling Ratio (logged):Initial Contract Ceiling (logged)
This interaction approximates has a role similar to that of contract ceiling, although due to centering and logging it isn't equivalent. Thus in essence it covers the dollars rather than merely the proportion available for options. More option  space gives more flexibility to the government and may lessen the need for ceiling breaches and terminations. Likewise, this interaction provides something like the dollar size of available  options, so naturally it can be associated with a greater spending.
(Options, Breach, Terminations)
Initial Contract Ceiling (logged)	clr_Ceil2Base:cln_Base		TRUE	++	-	-

```{r Model21A}
#Create the models
b_SomeOpt_base2ceil_ceiling_21A_no_interact <- glm(data=serv_opt,b_SomeOpt ~ clr_Ceil2Base + cln_Base, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_base2ceil_ceiling_21A_no_interact)

b_SomeOpt_base2ceil_ceiling_21A <- glm(data=serv_opt, b_SomeOpt ~ clr_Ceil2Base + cln_Base + clr_Ceil2Base:cln_Base, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_base2ceil_ceiling_21A)

b_AllOpt_base2ceil_ceiling_21A_no_interact <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ clr_Ceil2Base + cln_Base)

glmer_examine(b_AllOpt_base2ceil_ceiling_21A_no_interact)

b_AllOpt_base2ceil_ceiling_21A <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ clr_Ceil2Base + cln_Base + clr_Ceil2Base:cln_Base)
glmer_examine(b_AllOpt_base2ceil_ceiling_21A)

#Compare the Models
stargazer::stargazer(b_SomeOpt_base2ceil_ceiling_21A_no_interact, b_SomeOpt_base2ceil_ceiling_21A, 
                     b_AllOpt_base2ceil_ceiling_21A_no_interact, b_AllOpt_base2ceil_ceiling_21A, type="text", digits=2)

summary_residual_compare(b_SomeOpt_base2ceil_ceiling_21A_no_interact, b_SomeOpt_base2ceil_ceiling_21A)
summary_residual_compare(b_AllOpt_base2ceil_ceiling_21A_no_interact, b_AllOpt_base2ceil_ceiling_21A)
```
THe results are not significant and worsen the AIC. This seems unlikely to be included.
####21B: Cumulative
```{r Model21B}
#Create the model
b_SomeOpt_base2ceil_ceiling_21B <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+ 
                                  cp_OffPerf7:cln_PairCA+cp_OffPerf7:cp_PairObl7+
                 cp_OffPerf7:cln_Days+
                   clr_Ceil2Base:cln_Base, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_base2ceil_ceiling_21B)


b_AllOpt_base2ceil_ceiling_21B <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                   cln_Def6HHI+clr_Def6toUS+
                   #cln_Def3HHI+
                   clr_Def3toUS+
                   cp_PairObl7+
                   cln_OffObl7+
                   # cln_OffFocus+
                   cp_OffPerf7:cln_PairCA + 
                   clr_Ceil2Base:cln_Base)
glmer_examine(b_AllOpt_base2ceil_ceiling_21B)


b_AllOpt_base2ceil_ceiling_21B2 <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                   cln_Def6HHI+clr_Def6toUS+
                   #cln_Def3HHI+
                   clr_Def3toUS+
                   cp_PairObl7+
                   cln_OffObl7+
                   # cln_OffFocus+
                   # cp_OffPerf7:cln_PairCA + 
                   clr_Ceil2Base:cln_Base)
glmer_examine(b_AllOpt_base2ceil_ceiling_21B2)

#Compare the models
stargazer::stargazer(b_SomeOpt_partnership_duration_18B, b_SomeOpt_base2ceil_ceiling_21B, 
                     b_AllOpt_partnership_actions_16B, b_AllOpt_base2ceil_ceiling_21B2,  type="text", digits=2)

summary_residual_compare(b_SomeOpt_partnership_duration_18B, b_SomeOpt_base2ceil_ceiling_21B)
summary_residual_compare(b_AllOpt_partnership_actions_16B, b_AllOpt_base2ceil_ceiling_21B2)
```
The results are significant and positive, in line with expectations, in both cases. For breach size the residuals are perhaps lower magnitude residuals for the new model, although the significance and magnitude of the interaction coeffficient coefficient as well as the AIC are all better for the _pPBSC:cln_PairCA model. 

Adding for likelihood but leaving out for size, though it's a borderline judgment.

Current cumulative b_SomeOpt model: b_SomeOpt_base2ceil_ceiling_21B
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B

####21C: Available Options:Initial Contract Duration (logged)
increase the extend of options exercised as it means continuing a contract rather than including additional features. Option years may also provide more options for cost controls. and reduce ceiling breaches.
(Options, Ceiling Breach, Terminations)
++	-	-
```{r Model21C}
b_SomeOpt_base2ceil_duration_21C_no_interact <- glm(data=serv_opt, b_SomeOpt ~ clr_Ceil2Base + cln_Days, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_base2ceil_duration_21C_no_interact)

b_SomeOpt_base2ceil_duration_21C <- glm(data=serv_opt, b_SomeOpt ~ clr_Ceil2Base + cln_Days + clr_Ceil2Base:cln_Days, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_base2ceil_duration_21C)

b_AllOpt_base2ceil_duration_21C_no_interact <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ clr_Ceil2Base + cln_Days)
glmer_examine(b_AllOpt_base2ceil_duration_21C_no_interact)

b_AllOpt_base2ceil_duration_21C <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ clr_Ceil2Base + cln_Days + clr_Ceil2Base:cln_Days)
glmer_examine(b_AllOpt_base2ceil_duration_21C)

```
VIF exceeds 2 for both models.

####21D: Cumulative
```{r Model21D}
#Create the model
b_SomeOpt_base2ceil_duration_21D <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+ 
                                  cp_OffPerf7:cln_PairCA+cp_OffPerf7:cp_PairObl7+
                 cp_OffPerf7:cln_Days+
                   clr_Ceil2Base:cln_Days+
                   clr_Ceil2Base:cln_Base, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_base2ceil_duration_21D)

b_AllOpt_base2ceil_duration_21D <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   cp_OffPerf7:cln_PairCA+
                   clr_Ceil2Base:cln_Days)
glmer_examine(b_AllOpt_base2ceil_duration_21D)

b_AllOpt_base2ceil_duration_21D2 <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+
                   # cp_OffPerf7:cln_PairCA+
                   clr_Ceil2Base:cln_Days)
glmer_examine(b_AllOpt_base2ceil_duration_21D2)


#Compare the models
stargazer::stargazer(b_SomeOpt_base2ceil_ceiling_21B, b_SomeOpt_base2ceil_duration_21D, 
                     b_AllOpt_partnership_actions_16B, b_AllOpt_base2ceil_duration_21D2, type="text", digits=2)

summary_residual_compare(b_SomeOpt_base2ceil_ceiling_21B, b_SomeOpt_base2ceil_duration_21D)
summary_residual_compare(b_AllOpt_partnership_actions_16B, b_AllOpt_base2ceil_duration_21D2)
```
In neither case is the new variable significant nor does it reduce VIF. Leaving it out.

Current cumulative b_SomeOpt model: b_SomeOpt_base2ceil_ceiling_21B
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B


####22A: CFTE (logged):Contract Pricing
Cost-based and incentive contract types may do a  better job at handling complex contracts.

```{r Model22A}
#Create the models
b_SomeOpt_CFTE_pricing_22A_no_interact <- glm(data=serv_opt, b_SomeOpt ~ Pricing + cln_PSCrate, 
                                             family=binomial(link="logit"))
glmer_examine(b_SomeOpt_CFTE_pricing_22A_no_interact)

b_SomeOpt_CFTE_pricing_22A <- glm(data=serv_opt, b_SomeOpt ~ Pricing + cln_PSCrate + Pricing:cln_PSCrate,
                                 family=binomial(link="logit"))
glmer_examine(b_SomeOpt_CFTE_pricing_22A)


b_AllOpt_CFTE_pricing_22A_no_interact <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ Pricing + cln_PSCrate)
glmer_examine(b_AllOpt_CFTE_pricing_22A_no_interact)

b_AllOpt_CFTE_pricing_22A <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ Pricing + cln_PSCrate + Pricing:cln_PSCrate)
glmer_examine(b_AllOpt_CFTE_pricing_22A)


#compare the models

stargazer::stargazer(b_SomeOpt_CFTE_pricing_22A_no_interact, b_SomeOpt_CFTE_pricing_22A, 
                     b_SomeOpt_salary_pricing_15A_no_interact, b_SomeOpt_salary_pricing_15A, 
                     type="text", digits=2)
stargazer::stargazer(b_AllOpt_salary_pricing_15A_no_interact, b_AllOpt_salary_pricing_15A, 
                     b_AllOpt_CFTE_pricing_22A_no_interact, b_AllOpt_CFTE_pricing_22A, type="text", digits=2)

summary_residual_compare(b_SomeOpt_CFTE_pricing_22A_no_interact, b_SomeOpt_CFTE_pricing_22A, bins=5)
summary_residual_compare(b_AllOpt_CFTE_pricing_22A_no_interact, b_AllOpt_CFTE_pricing_22A, bins=3)

```

####22B: Cumulative
```{r Model22B}
#Create the model
b_SomeOpt_CFTE_pricing_22B <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+ 
                                     cp_OffPerf7:cln_PairCA+
                   cp_OffPerf7:cp_PairObl7+
                 cp_OffPerf7:cln_Days+
                   clr_Ceil2Base:cln_Base+
                 Pricing:cln_PSCrate, family=binomial(link="logit"))
glmer_examine(b_SomeOpt_CFTE_pricing_22B)

b_AllOpt_CFTE_pricing_22B <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                   cp_OffPerf7:cln_PairCA+
                 #cln_OffFocus+
                   Pricing:cln_PSCrate)
glmer_examine(b_AllOpt_CFTE_pricing_22B)

b_AllOpt_CFTE_pricing_22B2 <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                   # cp_OffPerf7:cln_PairCA+
                 #cln_OffFocus+
                   Pricing:cln_PSCrate)
glmer_examine(b_AllOpt_CFTE_pricing_22B2)

#Compare the models
  stargazer::stargazer(b_SomeOpt_base2ceil_ceiling_21B, b_SomeOpt_CFTE_pricing_22B, 
                       b_AllOpt_partnership_actions_16B, b_AllOpt_CFTE_pricing_22B2, type="text", digits=2)

summary_residual_compare(b_SomeOpt12C3, b_SomeOpt_CFTE_pricing_22B)
summary_residual_compare(b_AllOpt_partnership_actions_16B, b_AllOpt_CFTE_pricing_22B)

```
For likelihood, the coefficient for other cost-base and combination or other are negative and significant as expected. The coefficient for Incentive is significant quite large and positive while the coefficient for other fixed price is significantly positive and substantial, in both cases contrary to expectation

For size, VIF again precludes multiple interactions. c_PBSC:cp_PairObl7 more closely aligns with expectations and has a lower AIC, making keeping it an easy choice.

Current cumulative b_SomeOpt model: b_SomeOpt_base2ceil_ceiling_22B
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B

####23A: Office Serv. Code Exp:Office Obligations
A large office may be able to more effectively divide its attention, limiting the downsizes of a small experience share.  The estimated outcomes are negative for options and positive for ceiling breaches and terminations because this would be expected to enhance the better performance outcomes expected for the input of cp_PSC7

(Options, Ceiling, Termination)
Interact: Office Obligations	cp_PSC7:cln_OffObl7			-	+	+

```{r Model23A}
#Create the models
b_SomeOpt23A_no_interact <- glm(data=serv_opt, b_SomeOpt ~ pOffPSC + cln_OffObl7, 
                                             family=binomial(link="logit"))
glmer_examine(b_SomeOpt23A_no_interact)

b_SomeOpt23A <- glm(data=serv_opt, b_SomeOpt ~ pOffPSC + cln_OffObl7 + pOffPSC:cln_OffObl7,
                                 family=binomial(link="logit"))
glmer_examine(b_SomeOpt23A)


b_AllOpt23A_no_interact <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ pOffPSC + cln_OffObl7)
glmer_examine(b_AllOpt23A_no_interact)

b_AllOpt23A <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ pOffPSC + cln_OffObl7 + pOffPSC:cln_OffObl7)
glmer_examine(b_AllOpt23A)


#compare the models

stargazer::stargazer(b_SomeOpt23A_no_interact, 
                     b_SomeOpt23A, b_AllOpt23A_no_interact, b_AllOpt23A, 
                     type="text", digits=2)


summary_residual_compare(b_SomeOpt23A_no_interact, b_SomeOpt23A, bins=5)
summary_residual_compare(b_AllOpt23A_no_interact, b_AllOpt23A, bins=3)

```
Results were significant and negative, counter to expectations for breach likelihood. For size the results were significant and positive, in line with expectations, and did make a greater reduction in AIC>
####23B: Cumulative
```{r Model23B}
#Create the model
b_SomeOpt23B <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 #cln_OffFocus+ 
                                     cp_OffPerf7:cln_PairCA+
                   cp_OffPerf7:cp_PairObl7+
                 cp_OffPerf7:cln_Days+
                   clr_Ceil2Base:cln_Base+
                 Pricing:cln_PSCrate+
                   pOffPSC:cln_OffObl7, family=binomial(link="logit"))
glmer_examine(b_SomeOpt23B)

b_AllOpt23B <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                   cp_OffPerf7:cln_PairCA+
                 #cln_OffFocus+
                   pOffPSC:cln_OffObl7)
glmer_examine(b_AllOpt23B)

b_AllOpt23B2 <- glm(data=serv_exeropt, family=binomial(link="logit"), b_AllOpt ~ cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 #cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                   # cp_OffPerf7:cln_PairCA+
                 #cln_OffFocus+
                   pOffPSC:cln_OffObl7)
glmer_examine(b_AllOpt23B2)

#Compare the models
  stargazer::stargazer(b_SomeOpt_CFTE_pricing_22B, b_SomeOpt23B, 
                       b_AllOpt_partnership_actions_16B, b_AllOpt23B2, type="text", digits=2)

summary_residual_compare(b_SomeOpt_CFTE_pricing_22B, b_SomeOpt23B)
summary_residual_compare(b_AllOpt_partnership_actions_16B, b_AllOpt22B)

```
Remains negative and contrary to expectation for likelihood. Positive and in line with expectation for ceiling breach size, but would require removing a prior interaction to avoid multicollienarity and c_pPSC:cl:PairCAis associated with a lower AIC. Leaving it out.

Current cumulative b_SomeOpt model: b_SomeOpt_base2ceil_ceiling_22B
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B


####24A: Restoring cln_Def3HHI and cln_OffFocus
```{r Model24A}
#Create the model
b_SomeOpt24A <- b_SomeOpt_CFTE_pricing_22B <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 cln_OffFocus+
                                     cp_OffPerf7:cln_PairCA+
                   cp_OffPerf7:cp_PairObl7+
                 cp_OffPerf7:cln_Days+
                   clr_Ceil2Base:cln_Base+
                 Pricing:cln_PSCrate
  , family=binomial(link="logit"))
glmer_examine(b_SomeOpt24A)


#Compare the models
  stargazer::stargazer(b_SomeOpt_CFTE_pricing_22B, b_SomeOpt24A, type="text", digits=2)

summary_residual_compare(b_SomeOpt_CFTE_pricing_22B, b_SomeOpt24A)

```

####24B: Office Serv. Code Exp:Office Focus
A large office may be able to more effectively divide its attention, limiting the downsizes of a small experience share.  The estimated outcomes are negative for options and positive for ceiling breaches and terminations because this would be expected to enhance the better performance outcomes expected for the input of cp_PSC7

(Options, Ceiling, Termination)
Interact: Office Obligations	cp_PSC7:cln_OffObl7			-	+	+

```{r Model24B}
#Create the models
b_SomeOpt24B_no_interact <- glm(data=serv_opt, b_SomeOpt ~ pOffPSC + cln_OffFocus, 
                                             family=binomial(link="logit"))
glmer_examine(b_SomeOpt24B_no_interact)

b_SomeOpt24B <- glm(data=serv_opt, b_SomeOpt ~ pOffPSC + cln_OffFocus + pOffPSC:cln_OffFocus,
                                 family=binomial(link="logit"))
glmer_examine(b_SomeOpt24B)


```
VIF measures indicate multicolinearity.

####24C: Cumulative
```{r Model24C}
#Create the model
b_SomeOpt24C <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 cln_OffFocus+
                                     cp_OffPerf7:cln_PairCA+
                   cp_OffPerf7:cp_PairObl7+
                 cp_OffPerf7:cln_Days+
                   clr_Ceil2Base:cln_Base+
                 Pricing:cln_PSCrate+
                   pOffPSC:cln_OffFocus, family=binomial(link="logit"))
glmer_examine(b_SomeOpt24C)

b_SomeOpt24C2 <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 cln_OffFocus+
                                     cp_OffPerf7:cln_PairCA+
                   # cp_OffPerf7:cp_PairObl7+
                 cp_OffPerf7:cln_Days+
                   clr_Ceil2Base:cln_Base+
                 Pricing:cln_PSCrate+
                   pOffPSC:cln_OffFocus, family=binomial(link="logit"))
glmer_examine(b_SomeOpt24C2)


b_SomeOpt24C3 <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 cln_OffFocus+
                                     # cp_OffPerf7:cln_PairCA+
                   # cp_OffPerf7:cp_PairObl7+
                 cp_OffPerf7:cln_Days+
                   clr_Ceil2Base:cln_Base+
                 Pricing:cln_PSCrate+
                   pOffPSC:cln_OffFocus, family=binomial(link="logit"))
glmer_examine(b_SomeOpt24C3)


b_SomeOpt24C4 <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 cln_OffFocus+
                                     # cp_OffPerf7:cln_PairCA+
                   # cp_OffPerf7:cp_PairObl7+
                 # cp_OffPerf7:cln_Days+
                   clr_Ceil2Base:cln_Base+
                 Pricing:cln_PSCrate+
                   pOffPSC:cln_OffFocus, family=binomial(link="logit"))
glmer_examine(b_SomeOpt24C4)

```
VIF precludes inclusion


####24D: Office Obligations:Office Focus
A large office may be able to more effectively divide its attention, limiting the upsides of focus. The estimated outcomes are negative for options and positive for ceiling breaches and terminations because this would be expected to enhance the better performance outcomes expected for the input of cp_PSC7

(Options, Ceiling, Termination)
Interact: Office Obligations	cp_PSC7:cln_OffObl7			-	+	+

```{r Model24D}
#Create the models
b_SomeOpt24D_no_interact <- glm(data=serv_opt, b_SomeOpt ~ cln_OffObl7 + cln_OffFocus, 
                                             family=binomial(link="logit"))
glmer_examine(b_SomeOpt24D_no_interact)

b_SomeOpt24D <- glm(data=serv_opt, b_SomeOpt ~ cln_OffObl7 + cln_OffFocus + cln_OffObl7:cln_OffFocus,
                                 family=binomial(link="logit"))
glmer_examine(b_SomeOpt24D)


```
VIF measures indicate multicolinearity.

####24E: Cumulative
```{r Model24E}
#Create the model
b_SomeOpt24E <- glm(data=serv_opt,
                        b_SomeOpt ~  cln_US6sal + 
                   cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                 cn_PairHist7+cln_PairCA+
                 cln_Base + clr_Ceil2Base + cln_Days+
                 Comp+
                   Veh+
                   Pricing+
                   Crisis+
                 cln_Def6HHI+clr_Def6toUS+
                 cln_Def3HHI+
                   clr_Def3toUS+
                 cp_PairObl7+
                   cln_OffObl7+ 
                 cln_OffFocus+
                                     cp_OffPerf7:cln_PairCA+
                   cp_OffPerf7:cp_PairObl7+
                 cp_OffPerf7:cln_Days+
                   clr_Ceil2Base:cln_Base+
                 Pricing:cln_PSCrate+
                   cln_OffObl7:cln_OffFocus, family=binomial(link="logit"))
glmer_examine(b_SomeOpt24E)

#Compare the models
  stargazer::stargazer(b_SomeOpt24A, b_SomeOpt24E, type="text", digits=2)

summary_residual_compare(b_SomeOpt24A, b_SomeOpt24E)

```
Significant and nagative, contrary to expectation, leaving out.
# Multilevel Model
####25A: 2019-08-20 First run, original multilevel.
This was created while we were still using ceiling instead of base.

Current cumulative b_SomeOpt model: b_SomeOpt_base2ceil_ceiling_21B
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B

```{r CBre25A}
if(file.exists("..//Output//CBre25A.rda")) load("..//Output//CBre25A.rda")

if(!exists("b_SomeOpt25A")){
#Create the model
  b_SomeOpt25A <- glmer(data=serv_opt, b_SomeOpt ~  cln_US6sal + 
                       cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                       cn_PairHist7+cln_PairCA+
                       cln_Base + clr_Ceil2Base + cln_Days+
                       Comp+
                       Veh+
                       Pricing+
                       Crisis+
                       cln_Def6HHI+clr_Def6toUS+
                       #cln_Def3HHI+
                       clr_Def3toUS+
                       cp_PairObl7+
                       cln_OffObl7+ 
                       #cln_OffFocus+ 
                       cp_OffPerf7:cln_PairCA+cp_OffPerf7:cp_PairObl7+
                       cp_OffPerf7:cln_Days+
                       clr_Ceil2Base:cln_Base+
                       (1 | NAICS3/NAICS6/ServArea)+  
                       (1 | Agency/Office) +
                       (1 | Place)+ 
                       (1 | StartFY),
                     family=binomial(link="logit"),
                     verbose=TRUE)

  
  
  b_AllOpt25A <- lmer(data=serv_breach, b_AllOpt ~ cln_US6sal + 
                      cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                      cn_PairHist7+cln_PairCA+
                      cln_Base + clr_Ceil2Base + cln_Days+
                      Comp+
                      Veh+
                      Pricing+
                      Crisis+
                      cln_Def6HHI+clr_Def6toUS+
                      #cln_Def3HHI+
                      clr_Def3toUS+
                      cp_PairObl7+
                      cln_OffObl7+ 
                      #cl_office_NAICS6_hhi_kc+
                      cp_OffPerf7:cln_PairCA+
                      (1 | NAICS3/NAICS6/ServArea)+  
                      (1 | Agency/Office) +
                      (1 | Place)+ 
                      (1 | StartFY),
                    verbose=TRUE)
  
  save(b_SomeOpt25A,b_AllOpt25A,file="..\\output\\CBre25A.rda")
}

#Compare the models
  glmer_examine(b_SomeOpt25A,display = TRUE)
glmer_examine(b_AllOpt25A,display = TRUE)


stargazer::stargazer(b_SomeOpt_base2ceil_ceiling_21B, b_SomeOpt25A, 
                     b_AllOpt_partnership_actions_16B, b_AllOpt25A, type="text", digits=2)


summary_residual_compare( term_base2ceil_ceiling_21B, term25A,bins=100)
```
Both models  failed to converge after a 100000 evaluations but the boolean model took a lot longer which, combined with multiple interactions and study variables losing significance, suggests that perhaps the  interactions should  be trimmed back.


####26A: 2019-08-21 For size, swapping from p_PBSC to PairCA and base:basetoceiling ratio

Dropping PBSC:pairCA for both models. For likelihood it's contrary to expectation and for size the base variables are no longer significant. 

Current cumulative b_SomeOpt model: b_SomeOpt_base2ceil_ceiling_21B; b_SomeOpt25A
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B; b_AllOpt25A

```{r Term26A}
if(file.exists("..//Output//b_AllOpt26A.rda")) load("..//Output//b_AllOpt26A.rda")

if(!exists("b_AllOpt26A")){
  #Create the model
  b_AllOpt26A <- lmer(data=serv_breach, b_AllOpt ~ cln_US6sal + 
                      cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                      cn_PairHist7+cln_PairCA+
                      cln_Base + clr_Ceil2Base + cln_Days+
                      Comp+
                      Veh+
                      Pricing+
                      Crisis+
                      cln_Def6HHI+clr_Def6toUS+
                      #cln_Def3HHI+
                      clr_Def3toUS+
                      cp_PairObl7+
                      cln_OffObl7+ 
                      #cl_office_NAICS6_hhi_kc+
                      # cp_OffPerf7:cln_PairCA+
                      clr_Ceil2Base:cln_Base+
                      (1 | NAICS3/NAICS6/ServArea)+  
                      (1 | Agency/Office) +
                      (1 | Place)+ 
                      (1 | StartFY),
                    verbose=TRUE)
  save(b_AllOpt26A,file="..\\output\\b_AllOpt26A.rda")
}
#Compare the models
glmer_examine(b_AllOpt26A,display = TRUE)



stargazer::stargazer(b_SomeOpt_base2ceil_ceiling_21B, b_SomeOpt25A, 
                     b_AllOpt_partnership_actions_16B, b_AllOpt25A, type="text", digits=2)


summary_residual_compare( term_base2ceil_ceiling_21B, term25A,bins=100)
```


####27A: 2019-08-22 CFTE:Pricing
Dropping cp_OffPerf7:cp_PairObl7 and cp_OffPerf7:cp_PairObl7 as they were not significant in 2A. Adding Pricing:cln_PSCrate as a realized that it is another way to consider Pricing:AverageSalary that turns out to avoid VIF problems in the likelihood of breach model. 

Current cumulative b_SomeOpt model: b_SomeOpt_CFTE_pricing_22B, b_SomeOpt25A
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B, b_AllOpt25A

```{r Term27A}
if(file.exists("..//Output//b_SomeOpt27A.rda")) load("..//Output//b_SomeOpt27A.rda")

if(!exists("b_SomeOpt27A")){
  #Create the model
  b_SomeOpt27A <- glmer(data=serv_opt, b_SomeOpt ~  cln_US6sal + 
                       cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                       cn_PairHist7+cln_PairCA+
                       cln_Base + clr_Ceil2Base + cln_Days+
                       Comp+
                       Veh+
                       Pricing+
                       Crisis+
                       cln_Def6HHI+clr_Def6toUS+
                       #cln_Def3HHI+
                       clr_Def3toUS+
                       cp_PairObl7+
                       cln_OffObl7+ 
                       #cln_OffFocus+ 
                       cp_OffPerf7:cln_PairCA+#cp_OffPerf7:cp_PairObl7+
                       cp_OffPerf7:cln_Days+
                       Pricing:cln_PSCrate+
                       #clr_Ceil2Base:cln_Base+
                       
                       (1 | NAICS3/NAICS6/ServArea)+  
                       (1 | Agency/Office) +
                       (1 | Place)+ 
                       (1 | StartFY),
                     family=binomial(link="logit"),
                     verbose=TRUE)
  save(b_SomeOpt27A,file="..\\output\\b_SomeOpt27A.rda")
}

glmer_examine(b_SomeOpt27A,display = TRUE)

stargazer::stargazer(b_SomeOpt_CFTE_pricing_22B, b_SomeOpt25A, b_SomeOpt27A, type="text", digits=2)


summary_residual_compare(b_SomeOpt_CFTE_pricing_22B, b_SomeOpt27A, b_SomeOpt25A, b_SomeOpt27A,bins=100)

```
AIC is a  bit lower but the results, when significant, are not in line with expectation. Leaving out CFTE:PPricing.


####28A: 2019-08-22 Just PBSC and pairCA/Days

Trimming down to interactions that are present in n_CBRre (pPBSC:cln_PairCA) or significant and in line with expectations (pPBSC:Days)


Dropping PBSC:pairCA for both models. For frequency it's contrary to expectation and for size the base variables are no longer significant. Also dropping  cp_OffPerf7:c_pMarketand for frequency, which is not siginifcant. Keeping base:ratio despite lack of significance because of switching to it for size.
This was created while we were still using ceiling instead of base.

Current cumulative b_SomeOpt model: b_SomeOpt_base2ceil_ceiling_21B; b_SomeOpt25A
Current cumulative b_AllOpt model: b_AllOpt_partnership_actions_16B; b_AllOpt25A

```{r b_SomeOpt28A}
if(file.exists("..//Output//b_SomeOpt28AB.rda")) load("..//Output//b_SomeOpt28AB.rda")

if(!exists("b_SomeOpt28B")){
  #Create the model
  b_SomeOpt28A <- glmer(data=serv_opt, b_SomeOpt ~  cln_US6sal +
                       cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                       cn_PairHist7+cln_PairCA+
                       cln_Base + clr_Ceil2Base + cln_Days+
                       Comp+
                       Veh+
                       Pricing+
                       Crisis+
                       cln_Def6HHI+clr_Def6toUS+
                       #cln_Def3HHI+
                       clr_Def3toUS+
                       cp_PairObl7+
                       cln_OffObl7+
                       #cln_OffFocus+
                       cp_OffPerf7:cln_PairCA+
                       #cp_OffPerf7:cp_PairObl7+
                       cp_OffPerf7:cln_Days+
                       # clr_Ceil2Base:cln_Base+
                       (1 | NAICS3/NAICS6/ServArea)+
                       (1 | Agency/Office) +
                       (1 | Place)+
                       (1 | StartFY),
                     family=binomial(link="logit"),
                     verbose=TRUE)
  
  b_SomeOpt28B <- glmer(data=serv_opt, b_SomeOpt ~  cln_US6sal +
                       cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                       cn_PairHist7+cln_PairCA+
                       cln_Base + clr_Ceil2Base + cln_Days+
                       Comp+
                       Veh+
                       Pricing+
                       Crisis+
                       cln_Def6HHI+clr_Def6toUS+
                       #cln_Def3HHI+
                       clr_Def3toUS+
                       cp_PairObl7+
                       cln_OffObl7+
                       #cln_OffFocus+
                       cp_OffPerf7:cln_PairCA+
                       #cp_OffPerf7:cp_PairObl7+
                       cp_OffPerf7:cln_Days+
                       # clr_Ceil2Base:cln_Base+
                       (1 | NAICS3/NAICS6/ServArea)+
                       (1 | Agency/Office) +
                       (1 | Place)+
                       (1 | StartFY),
                     family=binomial(link="logit"),
                     verbose=TRUE)
  save(b_SomeOpt28A,b_SomeOpt28B,file="..\\output\\b_SomeOpt28AB.rda")
}

#Compare the models
glmer_examine(b_SomeOpt28B,display = TRUE)

stargazer::stargazer(b_SomeOpt25A, b_SomeOpt28A, b_SomeOpt28B, type="text", digits=2)

summary_residual_compare( b_SomeOpt25A, b_SomeOpt28A,b_SomeOpt25A,b_SomeOpt28B,bins=100)
```

####29A: 2019-08-22 Restoring cln_Def3HHI and cln_OffFocus


```{r b_SomeOpt29A}
if(file.exists("..//Output//b_SomeOpt29AB.rda")) load("..//Output//b_SomeOpt29AB.rda")

if(!exists("b_SomeOpt29B")){
  #Create the model
  b_SomeOpt29A <- glmer(data=serv_opt, b_SomeOpt ~  cln_US6sal +
                       cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                       cn_PairHist7+cln_PairCA+
                       cln_Base + clr_Ceil2Base + cln_Days+
                       Comp+
                       Veh+
                       Pricing+
                       Crisis+
                       cln_Def6HHI+clr_Def6toUS+
                       cln_Def3HHI+
                       clr_Def3toUS+
                       cp_PairObl7+
                       cln_OffObl7+
                       cln_OffFocus+
                       cp_OffPerf7:cln_PairCA+
                       #cp_OffPerf7:cp_PairObl7+
                       cp_OffPerf7:cln_Days+
                       # clr_Ceil2Base:cln_Base+
                       (1 | NAICS3/NAICS6/ServArea)+
                       (1 | Agency/Office) +
                       (1 | Place)+
                       (1 | StartFY),
                     family=binomial(link="logit"),
                     verbose=TRUE)
  save(b_SomeOpt29A,file="..\\output\\b_SomeOpt29A.rda")
  
  b_SomeOpt29B <- glmer(data=serv_opt, b_SomeOpt ~  cln_US6sal +
                       cln_PSCrate+ cp_OffPerf7+cp_OffPSC7+
                       cn_PairHist7+cln_PairCA+
                       cln_Base + clr_Ceil2Base + cln_Days+
                       Comp+
                       Veh+
                       Pricing+
                       Crisis+
                       cln_Def6HHI+clr_Def6toUS+
                       #cln_Def3HHI+
                       clr_Def3toUS+
                       cp_PairObl7+
                       cln_OffObl7+
                       #cln_OffFocus+
                       cp_OffPerf7:cln_PairCA+
                       #cp_OffPerf7:cp_PairObl7+
                       cp_OffPerf7:cln_Days+
                       # clr_Ceil2Base:cln_Base+
                       (1 | NAICS3/NAICS6/ServArea)+
                       (1 | Agency/Office) +
                       (1 | Place)+
                       (1 | StartFY),
                     family=binomial(link="logit"),
                     verbose=TRUE)
  save(b_SomeOpt29A,b_SomeOpt29B,file="..\\output\\b_SomeOpt29AB.rda")
}

#Compare the models
glmer_examine(b_SomeOpt29B,display = TRUE)

stargazer::stargazer(b_SomeOpt25A, b_SomeOpt28A, b_SomeOpt29A, type="text", digits=2)

summary_residual_compare( b_SomeOpt25A, b_SomeOptA,b_SomeOpt25A,b_SomeOptB,bins=100)
```