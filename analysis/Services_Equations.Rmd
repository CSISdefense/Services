---
title: "Defense Services Equations"
output:
  word_document: default
  html_document: default
---

# Setup
First we load the data. The dataset used is a U.S. Defense Contracting dataset derived from   FPDS.
```{r Libraries, echo = FALSE, message=FALSE}
library(csis360)
library(ggplot2)
library(dplyr)
library(arm)
library(knitr)
library(foreign)
library(stargazer)
library(texreg)
library(reshape2)
library(tidyverse)
source("https://raw.githubusercontent.com/CSISdefense/Vendor/master/Scripts/DIIGstat.r")

```

# Options

Note that because we use the complete dataset for exercised options, there's no 1 million entry variant.
```{r Model-OptGrowth, echo = FALSE, message=FALSE}
# Deprecated
load("..//Output//b_SomeOpt25Cv3.rda")
# 

load("..//Output//b_AllOpt26A.rda")

stargazer(b_SomeOpt25Cv3,b_AllOpt26A,type="text",digits=2)
```
## Some Options Likelihood

$Estimated~Probability(y_i = 1)~=~Logit^{-1}(α~+~α^{NAICS3}_{j[i]}~+~α^{NAICS6:NAICS3}_{k[i]}~+$

$α^{NAICS6:NAICS3:ServArea}_{l[i]}~+~α^{Agency}_{m[i]}~+~α^{Office:Agency}_{n[i]}~+α^{Place}_{o[i]}~+~α^{StartFY}_{p[i]}~+$

$β_{1}Intercept~+~β_{2}cln\_US6sal_{i}~+~β_{3}cln\_PSCrate_{i}~+~β_{4}cp\_OffPerf7_{i}~+$

$β_{6}cp\_OffPSC7_{i}~+β_{7}cn\_PairHist7_{i}~+~β_{8}cln\_PairCA_{i}~+~β_{9}cln\_Base_{i}~+$

$β_{10}clr\_Ceil2Base_{i}~+~β_{11}cln\_Days_{i}~+~(~β_{12}1Offr_{i}~+~β_{13}2–4Offr_{i}+~β_{14}5plusOffr_{i}~)~+$

$(~β_{15}SIDC_{i}~+~β_{16}MIDC_{i}+~β_{17}FSS–GWAC_{i}+~β_{18}BPA–BOA_{i}~)~+(~β_{19}Other\_FP_{i}~+$

$β_{20}Incentive_{i}~+~β_{21}Comb–Other_{i}~+~β_{22}Other\_CB_{i}~+~β_{23}TM–LH–FPLOE_{i}~+$

$β_{24}UCA_{i}~)~+~(~+~β_{25}ARRA_{i}~+~β_{26}Dist_{i}~+~β_{27}OCO_{i}~)~+~β_{29}clr\_Def3toUS{i}~+$

$β_{29}cln\_Def6HHI_{i}~+~β_{30}clr\_Def6toUS_{i}~+~β_{31}cp\_PairObl7_{i}~+~β_{32}cln\_OffObl7_{i}~+$

$β_{33}cln\_OffFocus_{i}~+~β_{34}cp\_OffPSC7_{i}·cln\_OffObl7_{i}~+$

$β_{35}cln\_OffPerf7_{i}·cln\_PairCA_{i}~+~β_{36}cln\_OffPerf7_{i}·cp\_PairObl7_{i}~+$

$(~β_{37}cn\_OffPerf7_{i}·Other\_FP_{i}~+~β_{38}cn\_OffPerf7_{i}·Incentive_{i}~+$

$β_{39}cn\_OffPerf7_{i}·Other\_CB_{i}~+~β_{40}cn\_OffPerf7_{i}·TM–LH–FPLOE_{i}~+$

$β_{41}cn\_OffPerf7_{i}·UCA_{i}~)~+~β_{42}cln\_Base_{i}·clr\_Ceil2Base_{i}~+~$

$β_{43}cp\_PairObl7_{i}·cln\_OffObl7_{i}~+~ϵ_{i},~~~~for~i=1~to~1,000,000$

$$a^{NAICS3}_{j}\sim~N(μ_{α},σ^{2}_{α}),~for~j= 1~to~82;$$
$$a^{NAICS3:NAICS6}_{k}\sim~N(μ_{α},σ^{2}_{α}),~for~k= 1~to~973;$$
$$a^{NAICS3:NAICS6:ServArea}_{l}\sim~N(μ_{α},σ^{2}_{α}),~for~l= 1~to~973;$$
$$a^{Agency}_{m}\sim~N(μ_{α},σ^{2}_{α}),~for~m= 1~to~24$$
$$a^{Agency:Office}_{n}\sim~N(μ_{α},σ^{2}_{α}),~for~n= 1~to~1,462$$
$$a^{Place}_{o}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~n= 1~to~24$$
$$a^{StartFY}_{p}\sim~N(μ_{α},σ^{2}_{α}),~for~o= 1~to~24$$



## All Options Likelihood

$Estimated~Probability(y_i = 1)~=~Logit^{-1}(α~+~α^{NAICS3}_{j[i]}~+~α^{NAICS6:NAICS3}_{k[i]}~+$

$α^{NAICS6:NAICS3:ServArea}_{l[i]}~+~α^{Agency}_{m[i]}~+~α^{Office:Agency}_{n[i]}~+α^{Place}_{o[i]}~+~α^{StartFY}_{p[i]}~+$

$β_{1}Intercept~+~β_{2}cln\_US6sal_{i}~+~β_{3}cln\_PSCrate_{i}~+~β_{4}cp\_OffPerf7_{i}~+$

$β_{5}cp\_OffPSC7_{i}~+~β_{6}cn\_PairHist7_{i}~+~β_{7}cln\_PairCA_{i}~+~β_{8}cln\_Base_{i}~+$

$β_{9}clr\_Ceil2Base_{i}~+~β_{10}cln\_Days_{i}~+~(~β_{11}1Offr_{i}~+~β_{12}2–4Offr_{i}+~β_{13}5plusOffr_{i}~)~+$

$(~β_{14}SIDC_{i}~+~β_{15}MIDC_{i}+~β_{16}FSS–GWAC_{i}+~β_{17}BPA–BOA_{i}~)~+(~β_{18}Other\_FP_{i}~+$

$β_{19}Incentive_{i}~+β_{20}Comb–Other_{i}~+~β_{21}Other\_CB_{i}~+~β_{22}TM–LH–FPLOE_{i}~+$

$β_{23}UCA_{i}~)~+~(~β_{24}ARRA_{i}~+~β_{25}Dist_{i}~+~β_{26}OCO_{i}~)~+~β_{27}clr\_Def3toUS{i}~+$

$β_{28}cln\_Def6HHI_{i}~+~β_{29}clr\_Def6toUS_{i}~+~β_{30}cp\_PairObl7_{i}~+~β_{31}cln\_OffObl7_{i}~+$

$β_{32}cln\_OffFocus_{i}~+~β_{32}cln\_OffPSC7_{i}·cln\_OffFocus_{i}~+$

$(~β_{33}cn\_PSCrate_{i}·Other\_FP_{i}~+~β_{34}cn\_PSCrate_{i}·Incentive_{i}~+$

$β_{35}cn\_PSCrate_{i}·Comb–Other_{i}~+~β_{36}cn\_PSCrate_{i}·Other\_CB_{i}~+$

$β_{37}cn\_PSCrate_{i}·TM–LH–FPLOE_{i}~+~β_{38}cn\_PSCrate_{i}·UCA_{i}~)~+$

$β_{39}cln\_OffObl7_{i}·cln\_OffFocus_{i}~+~ϵ_{i},~~~~for~i=1~to~1,000,000$

$$a^{NAICS3}_{j}\sim~N(μ_{α},σ^{2}_{α}),~for~j= 1~to~82;$$
$$a^{NAICS3:NAICS6}_{k}\sim~N(μ_{α},σ^{2}_{α}),~for~k= 1~to~973;$$
$$a^{NAICS3:NAICS6:ServArea}_{l}\sim~N(μ_{α},σ^{2}_{α}),~for~l= 1~to~973;$$
$$a^{Agency}_{m}\sim~N(μ_{α},σ^{2}_{α}),~for~m= 1~to~24$$
$$a^{Agency:Office}_{n}\sim~N(μ_{α},σ^{2}_{α}),~for~n= 1~to~1,462$$
$$a^{Place}_{o}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~n= 1~to~24$$
$$a^{StartFY}_{p}\sim~N(μ_{α},σ^{2}_{α}),~for~o= 1~to~24$$



# Ceiling Breach

```{r Model-CBre, echo = FALSE, message=FALSE}
if(file.exists("..//Output//b_CBre29AB.rda")) load("..//Output//b_CBre29AB.rda")


if(file.exists("..//Output//CBre25A.rda")) load("..//Output//CBre25A.rda")

stargazer(b_CBre29B,n_CBre25A,type="text",digits=2)

```

## Breach Likelihood

$Estimated~Probability(y_i = 1)~=~Logit^{-1}(α~+~α^{NAICS3}_{j[i]}~+~α^{NAICS6:NAICS3}_{k[i]}~+$

$α^{NAICS6:NAICS3:ServArea}_{l[i]}~+~α^{Agency}_{m[i]}~+~α^{Office:Agency}_{n[i]}~+α^{Place}_{o[i]}~+~α^{StartFY}_{p[i]}~+$

$β_{1}Intercept~+~β_{2}cln\_US6sal_{i}~+~β_{3}cln\_PSCrate_{i}~+~β_{4}cp\_OffPerf7_{i}~+$

$β_{5}cp\_OffPSC7_{i}~+~β_{6}cn\_PairHist7_{i}~+~β_{7}cln\_PairCA_{i}~+~β_{8}cln\_Base_{i}~+$

$β_{9}clr\_Ceil2Base_{i}~+~β_{10}cln\_Days_{i}~+~(~β_{11}1Offr_{i}~+~β_{12}2–4Offr_{i}+~β_{13}5plusOffr_{i}~)~+$

$(~β_{14}SIDC_{i}~+~β_{15}MIDC_{i}+~β_{16}FSS–GWAC_{i}+~β_{17}BPA–BOA_{i}~)~+(~β_{18}Other\_FP_{i}~+$

$β_{19}Incentive_{i}~+~β_{20}Comb–Other_{i}~+~β_{21}Other\_CB_{i}~+~β_{22}TM–LH–FPLOE_{i}~+$

$β_{23}UCA_{i}~)~+~(~β_{24}ARRA_{i}~+~β_{25}Dist_{i}~+~β_{26}OCO_{i}~)~+~β_{27}clr\_Def3toUS{i}~+$

$β_{28}cln\_Def6HHI_{i}~+~β_{29}clr\_Def6toUS_{i}~+~β_{30}cp\_PairObl7_{i}~+~β_{31}cln\_OffObl7_{i}~+$

$β_{32}cln\_OffFocus_{i}~+~β_{33}cln\_OffPerf7_{i}·cln\_PairCA_{i}~+$

$β_{34}cln\_OffPerf7_{i}·cln\_Days_{i}~+~ϵ_{i},~~~for~i=  1~to~1,000,000$

$$a^{NAICS3}_{j}\sim~N(μ_{α},σ^{2}_{α}),~for~j= 1~to~82;$$
$$a^{NAICS3:NAICS6}_{k}\sim~N(μ_{α},σ^{2}_{α}),~for~k= 1~to~973;$$
$$a^{NAICS3:NAICS6:ServArea}_{l}\sim~N(μ_{α},σ^{2}_{α}),~for~l= 1~to~973;$$
$$a^{Agency}_{m}\sim~N(μ_{α},σ^{2}_{α}),~for~m= 1~to~24$$
$$a^{Agency:Office}_{n}\sim~N(μ_{α},σ^{2}_{α}),~for~n= 1~to~1,462$$
$$a^{Place}_{o}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~n= 1~to~24$$
$$a^{StartFY}_{p}\sim~N(μ_{α},σ^{2}_{α}),~for~o= 1~to~24$$

## Breach Size

$Estimated~Log(y_i)~=~α~+~α^{NAICS3}_{j[i]}~+~α^{NAICS6:NAICS3}_{k[i]}~+~α^{NAICS6:NAICS3:ServArea}_{l[i]}~+$

$α^{Agency}_{m[i]}~+~α^{Office:Agency}_{n[i]}~+~α^{Place}_{o[i]}~+~α^{StartFY}_{p[i]}~+~β_{1}Intercept~+$

$β_{2}cln\_US6sal_{i}~+~β_{3}cln\_PSCrate_{i}~+~β_{4}cp\_OffPerf7_{i}~+~β_{5}cp\_OffPSC7_{i}~+~β_{6}cn\_PairHist7_{i}~+$

$β_{7}cln\_PairCA_{i}~+~β_{8}cln\_Base_{i}~+~β_{9}clr\_Ceil2Base_{i}~+~β_{10}cln\_Days_{i}~+$

$(~β_{11}1Offr_{i}~+~β_{12}2–4Offr_{i}+~β_{13}5plusOffr_{i}~)~+~(~β_{14}SIDC_{i}~+~β_{15}MIDC_{i}~+~$

$β_{16}FSS–GWAC_{i}+~β_{17}BPA–BOA_{i}~)~+(~β_{18}Other\_FP_{i}~+~β_{19}Incentive_{i}~+$

$β_{20}Comb–Other_{i}~+~β_{21}Other\_CB_{i}~+~β_{22}TM–LH–FPLOE_{i}~+~β_{23}UCA_{i}~)~+$

$(~β_{24}ARRA_{i}~+~β_{25}Dist_{i}~+~β_{26}OCO_{i}~)~+~β_{27}clr\_Def3toUS{i}~+~β_{28}cln\_Def6HHI_{i}~+$

$β_{29}clr\_Def6toUS_{i}~+~β_{30}cp\_PairObl7_{i}~+~β_{31}cln\_OffObl7_{i}~+~β_{32}cln\_OffFocus_{i}~+$

$β_{33}cp\_OffPerf7_{i}·cln\_PairCA_{i}~+~ϵ_{i}~+~ϵ_{i}, for~i=  1~to~1,000,000$

$$a^{NAICS3}_{j}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~j=1~to~80$$
$$a^{NAICS6:NAICS3}_{k}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~k= 1~to~813$$
$$a^{ServArea:NAICS6:NAICS3}_{l}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~l= 1~to~813$$
$$a^{Agency}_{m}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~l= 1~to~24$$
$$a^{Office:Agency}_{n}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~m= 1~to~880$$
$$a^{Place}_{o}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~n= 1~to~24$$
$$a^{StartFY}_{p}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~o= 1~to~24$$


#Terminations

```{r Model-Term, echo = FALSE, message=FALSE}
 load("..//Output//term25B.rdata")

stargazer(term25B,type="text",digits=2)

```

$Estimated~Probability(y_i = 1)~=~Logit^{-1}(α~+~α^{NAICS3}_{j[i]}~+~α^{NAICS6:NAICS3}_{k[i]}~+$

$α^{NAICS6:NAICS3:ServArea}_{l[i]}~+~α^{Agency}_{m[i]}~+~α^{Office:Agency}_{n[i]}~+α^{Place}_{o[i]}~+~α^{StartFY}_{p[i]}~+$

$β_{1}Intercept_{i}~+~β_{2}cln\_US6sal_{i}~+~β_{3}cln\_PSCrate_{i}~+~β_{4}cp\_OffPerf7_{i}~+$

$β_{5}cp\_OffPSC7_{i}~+~β_{6}cn\_PairHist7_{i}~+~β_{7}cln\_PairCA_{i}~+~β_{8}cln\_Base_{i}~+$

$β_{9}clr\_Ceil2Base_{i}~+~β_{10}cln\_Days_{i}~+~(~β_{11}1Offr_{i}~+~β_{12}2–4Offr_{i}+~β_{13}5plusOffr_{i}~)~+$

$(~β_{14}SIDC_{i}~+~β_{15}MIDC_{i}+~β_{16}FSS–GWAC_{i}+~β_{17}BPA–BOA_{i}~)~+(~β_{18}Other\_FP_{i}~+$

$β_{19}Incentive_{i}~+~β_{20}Comb–Other_{i}~+~β_{21}Other\_CB_{i}~+~β_{22}TM–LH–FPLOE_{i}~+$

$β_{23}UCA_{i}~)~+~(~β_{24}ARRA_{i}~+~β_{25}Dist_{i}~+~β_{26}OCO_{i}~)~+~β_{27}clr\_Def3toUS{i}~+$

$β_{28}cln\_Def6HHI_{i}~+~β_{29}clr\_Def6toUS_{i}~+~β_{30}cp\_PairObl7_{i}~+~β_{31}cln\_OffObl7_{i}~+$

$β_{32}cln\_OffFocus_{i}~+~(~β_{32}cn\_PairHist7_{i}·Other\_FP_{i}~+$

$β_{33}cn\_PairHist7_{i}·Incentive_{i}~+~β_{34}cn\_PairHist7_{i}·Comb–Other_{i}~+$

$β_{35}cn\_PairHist7_{i}·Other\_CB_{i}~+~β_{36}cn\_PairHist7_{i}·TM–LH–FPLOE_{i}~+$

$β_{37}cn\_PairHist7_{i}·UCA_{i}~)~+~ϵ_{i}~+~ϵ_{i},~~~~for~i=1~to~1,000,000$

$$a^{NAICS3}_{j}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~j=1~to~80$$
$$a^{NAICS6:NAICS3}_{k}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~k= 1~to~813$$
$$a^{ServArea:NAICS6:NAICS3}_{l}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~l= 1~to~813$$
$$a^{Agency}_{m}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~l= 1~to~24$$
$$a^{Office:Agency}_{n}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~m= 1~to~880$$
$$a^{Place}_{o}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~n= 1~to~24$$
$$a^{StartFY}_{p}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~o= 1~to~24$$

$$a^{NAICS3}_{j}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~j=1~to~82$$
$$a^{NAICS6:NAICS3}_{k}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~k= 1~to~878$$
$$a^{ServArea:NAICS6:NAICS3}_{k}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~l= 1~to~3,242$$
$$a^{Agency}_{l}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~l= 1~to~26$$
$$a^{Office:Agency}_{m}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~m= 1~to~1,092$$
$$a^{Place}_{n}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~n= 1~to~186$$
$$a^{StartFY}_{o}\sim~N(μ_{α},σ^{2}_{α}),~~~~for~o= 1~to~9$$

